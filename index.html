<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Duoplanning ‚Äî Mestre do Planejamento</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f1115">
  <style>
    :root { 
      --bg:#0f1115; --panel:#151923; --text:#e9eef7; --muted:#a7b1c2; --accent:#58cc02; --border:#273046; 
      --danger:#ff4d4f; --success:#27ae60;
      /* Cores por n√≠vel */
      --lv-tec:#58cc02;      /* T√©cnico */
      --lv-ana:#3aa0ff;      /* Analista */
      --lv-esp:#7e57c2;      /* Especialista */
      --lv-ger:#f2b01c;      /* Gerente/Diretor */
      --lv-vis:#00bcd4;      /* Vision√°rio */
    }
    html,body{width:100%;height:100%;margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;overflow-x:hidden}
    .full-center{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}
    .container{width:100%;max-width:480px;margin:0 auto;padding:0 20px;box-sizing:border-box}
    .panel{background:var(--panel);border-radius:12px;padding:20px;margin-bottom:15px;border:1px solid var(--border)}
    h1{font-size:2em;margin-bottom:0}
    h2{font-size:1.5em;margin-top:0;color:var(--accent)}
    .input-group{margin-bottom:15px;width:100%}
    input[type="text"], input[type="password"]{width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:var(--bg);color:var(--text);box-sizing:border-box}
    button{width:100%;padding:12px;border-radius:8px;border:none;font-weight:bold;cursor:pointer;margin-top:10px;transition:background-color 0.2s}
    .btn-google{background:#4285f4;color:white}
    .btn-google:hover{background:#357ae8}
    .btn-local{background:var(--accent);color:var(--bg)}
    .btn-local:hover{background:#44a502}
    .btn-danger{background:var(--danger);color:white}
    .btn-danger:hover{background:#cc3d3f}
    .btn-secondary{background:var(--border);color:var(--text)}
    .btn-secondary:hover{background:#3c4a63}
    .hidden{display:none!important}
    .row{display:flex;gap:10px;align-items:center}
    .badge{display:inline-block;padding:4px 8px;border-radius:15px;font-size:0.75em;font-weight:bold;margin-left:5px}
    .xp-bar{width:100%;height:10px;background:var(--border);border-radius:5px;margin-top:5px}
    .xp-fill{height:100%;background:var(--accent);border-radius:5px;transition:width 0.5s}
    .stat-box{text-align:center;padding:10px;border-radius:8px;background:var(--bg);flex:1;border:1px solid var(--border)}
    .stat-value{font-size:1.5em;font-weight:bold;color:var(--accent)}
    .quiz-options button{background:var(--panel);border:1px solid var(--border);margin-top:8px;text-align:left;white-space:normal;height:auto;line-height:1.3;color:var(--text)}
    .quiz-options button.selected{border:2px solid var(--accent);background:#232d43}
    .quiz-options button.correct{background:var(--success);color:white}
    .quiz-options button.incorrect{background:var(--danger);color:white}
    .footer-nav{display:flex;justify-content:space-around;padding:10px 0;border-top:1px solid var(--border);position:fixed;bottom:0;width:100%;max-width:480px;background:var(--panel);box-shadow:0 -2px 10px rgba(0,0,0,0.5);z-index:100}
    .nav-item{cursor:pointer;color:var(--muted);font-size:0.75em;text-align:center}
    .nav-item.active{color:var(--accent)}
    .nav-icon{font-size:1.5em}
    .module-card{padding:15px;border-radius:8px;margin-bottom:10px;cursor:pointer;transition:background-color 0.2s;position:relative}
    .module-card.locked{background:var(--panel);border:1px dashed var(--border)}
    .module-card.completed{background:var(--success);color:white!important}
    .module-card:not(.locked):hover{background:var(--border)}
    .module-card-title{font-weight:bold;margin-bottom:5px}
    .module-card .lock-icon{position:absolute;top:10px;right:15px;font-size:1.5em;color:var(--muted)}
    .module-card.locked .lock-icon{color:var(--danger)}
    .module-card.completed .lock-icon{color:white}
    .level-header{font-size:1.2em;font-weight:bold;margin-top:20px;margin-bottom:10px;padding-left:10px;border-left:4px solid var(--accent)}
    /* Cores dos n√≠veis na lista */
    .level-tec{border-left-color:var(--lv-tec)!important;color:var(--lv-tec)}
    .level-ana{border-left-color:var(--lv-ana)!important;color:var(--lv-ana)}
    .level-esp{border-left-color:var(--lv-esp)!important;color:var(--lv-esp)}
    .level-ger{border-left-color:var(--lv-ger)!important;color:var(--lv-ger)}
    .level-vis{border-left-color:var(--lv-vis)!important;color:var(--lv-vis)}
    
    .module-card[data-level='T√©cnico']{border-left:5px solid var(--lv-tec)}
    .module-card[data-level='Analista']{border-left:5px solid var(--lv-ana)}
    .module-card[data-level='Especialista']{border-left:5px solid var(--lv-esp)}
    .module-card[data-level='Gerente/Diretor']{border-left:5px solid var(--lv-ger)}
    .module-card[data-level='Vision√°rio']{border-left:5px solid var(--lv-vis)}
    
    .quiz-result-feedback{margin-top:15px;padding:15px;border-radius:8px;font-size:0.9em}
    .quiz-result-feedback.success{background-color:#27ae6030;border:1px solid var(--success)}
    .quiz-result-feedback.fail{background-color:#ff4d4f30;border:1px solid var(--danger)}
    .quiz-feedback-title{font-weight:bold;margin-bottom:5px}
    
    .loading-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 1000;
      font-size: 1.2em;
    }

  </style>
</head>
<body>
  
  <div id="loadingOverlay" class="loading-overlay">
    <div class="row">
      <span style="font-size:2em;">‚è≥</span>
      <span style="margin-left:10px;">Carregando Duoplanning...</span>
    </div>
  </div>

  <div id="viewLogin" class="full-center">
    <div class="container">
      <div class="panel">
        <h1 style="color:var(--accent);">Duoplanning</h1>
        <p style="color:var(--muted)">Mestre do Planejamento üß†</p>

        <div class="input-group">
          <input type="text" id="inpName" placeholder="Seu Nome/Apelido" value="Usu√°rio Local" />
        </div>
        
        <button id="btnGoogle" class="btn-google">
          <span style="font-size:1.2em; vertical-align:middle; margin-right:5px;">G</span> Entrar com Google
        </button>
        
        <button id="btnLocal" class="btn-local">
          Come√ßar sem Login (Dados Locais)
        </button>
        
        <p style="text-align:center; margin-top:15px; font-size:0.8em; color:var(--muted)">
          O login com Google salva seu progresso na nuvem.
        </p>
      </div>
    </div>
  </div>

  <div id="viewDash" class="hidden">
    <div class="container" style="padding-top:20px; padding-bottom:70px">
      
      <div class="panel">
        <div class="row" style="align-items:flex-start">
          <div>
            <h2 id="userName" style="margin-bottom:5px;">Ol√°, Mestre!</h2>
            <p id="userLevel" style="margin-top:0; font-weight:bold; color:var(--muted)">N√≠vel: Desconhecido</p>
          </div>
          <span id="rankBtn" class="badge" style="background:#f2b01c; color:var(--bg); margin-left:auto; cursor:pointer">Ranking üèÜ</span>
        </div>
        
        <p style="font-size:0.8em; margin:10px 0 5px 0">XP Total: <span id="xpCurrent">0</span></p>
        <div class="xp-bar"><div id="xpFill" class="xp-fill" style="width:0%"></div></div>

        <div class="row" style="margin-top:15px">
          <div class="stat-box">
            <div id="statCompleted" class="stat-value">0</div>
            <div style="font-size:0.8em; color:var(--muted)">M√≥dulos OK</div>
          </div>
          <div class="stat-box">
            <div id="statProgress" class="stat-value">0%</div>
            <div style="font-size:0.8em; color:var(--muted)">Progresso Total</div>
          </div>
          <div class="stat-box">
            <div id="statLevelBadge" class="stat-value" style="color:var(--lv-tec)">T</div>
            <div style="font-size:0.8em; color:var(--muted)">N√≠vel Atual</div>
          </div>
        </div>
      </div>
      
      <div id="modulesList">
        </div>
      
    </div>
    
    <div class="footer-nav">
      <div class="nav-item active" data-view="dashboard">
        <div class="nav-icon">üß†</div>
        <div>M√≥dulos</div>
      </div>
      <div id="navQuiz" class="nav-item" data-view="quiz">
        <div class="nav-icon">üî•</div>
        <div>Quiz</div>
      </div>
      <div class="nav-item" data-view="config">
        <div class="nav-icon">‚öôÔ∏è</div>
        <div>Ajustes</div>
      </div>
    </div>
  </div>

  <div id="viewQuiz" class="hidden">
    <div class="container" style="padding-top:20px; padding-bottom:70px">
      <h2 style="margin-top:0"><span id="quizModIcon"></span> M√≥dulo <span id="quizModId"></span>: <span id="quizModTitle"></span></h2>
      <p id="quizStory" style="color:var(--muted); font-style:italic; border-left:2px solid var(--accent); padding-left:10px;"></p>
      
      <div id="quizContent" class="panel">
        <p style="font-weight:bold; font-size:1.1em">Pergunta <span id="quizQIndex">1</span> de 8</p>
        <p id="quizQuestion" style="font-size:1.2em;"></p>
        
        <div id="quizOptions" class="quiz-options">
          </div>
        
        <div id="quizFeedback" class="hidden quiz-result-feedback">
          <div id="quizFeedbackTitle" class="quiz-feedback-title"></div>
          <div id="quizFeedbackExp"></div>
        </div>

        <button id="btnQuizNext" class="btn-local" style="margin-top:20px" disabled>Pr√≥xima Pergunta >></button>
        <button id="btnQuizFinish" class="btn-local hidden" style="margin-top:20px">Finalizar M√≥dulo</button>
      </div>
    </div>
  </div>
  
  <div id="viewConfig" class="hidden">
    <div class="container" style="padding-top:20px; padding-bottom:70px">
      <h2 style="margin-top:0">‚öôÔ∏è Ajustes</h2>
      
      <div class="panel">
        <h3 style="margin-top:0">Conta</h3>
        <p>Logado como: <span id="configUserName" style="font-weight:bold"></span></p>
        <p style="font-size:0.8em; color:var(--muted)">Para salvar seu progresso, use o Login com Google.</p>
        <button id="btnSignOut" class="btn-secondary">Sair da Conta</button>
      </div>

      <div class="panel">
        <h3 style="margin-top:0">Progresso</h3>
        <p style="font-size:0.9em">Se voc√™ zerar o progresso, todos os seus XP e m√≥dulos conclu√≠dos ser√£o perdidos.</p>
        <button id="btnReset" class="btn-danger">Zerar Todo o Progresso</button>
      </div>
      
      <div class="panel">
        <h3 style="margin-top:0">Desbloqueio de N√≠vel</h3>
        <p style="font-size:0.9em">Selecione um m√≥dulo bloqueado (com cadeado) e clique no √≠cone para digitar a senha de desbloqueio.</p>
        <p style="font-size:0.8em; color:var(--muted)">Senha atual: <span id="currentPass" style="font-weight:bold">2025*</span></p>
      </div>
    </div>
  </div>
  
  <div id="viewRanking" class="hidden">
    <div class="container" style="padding-top:20px; padding-bottom:70px">
      <h2 style="margin-top:0">üèÜ Ranking Global</h2>
      <div class="panel">
        <div id="rankBody" style="min-height:100px; color:var(--muted)">
          Carregando...
        </div>
      </div>
      <button id="btnBackFromRanking" class="btn-secondary">Voltar ao Dashboard</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, query, collection, orderBy, limit, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // Configura√ß√µes do Firebase (Mantenha as suas se houver)
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const provider = new GoogleAuthProvider();

    // Estado Global (Local Storage)
    let S = JSON.parse(localStorage.getItem('duoplanningState')) || {
      name: null,
      uid: null,
      xp: 0,
      completed: [], // IDs dos m√≥dulos conclu√≠dos
      updatedAt: 0,
      tempPass: '2025*' // Senha de desbloqueio
    };
    
    const TOTAL_MODULES = 40; // Total de m√≥dulos
    const XP_PER_MODULE = 100;
    const LEVELS = [
      { id: 'T√©cnico', minXp: 0, color: 'var(--lv-tec)' },
      { id: 'Analista', minXp: 1200, color: 'var(--lv-ana)' },
      { id: 'Especialista', minXp: 2000, color: 'var(--lv-esp)' },
      { id: 'Gerente/Diretor', minXp: 3000, color: 'var(--lv-ger)' },
      { id: 'Vision√°rio', minXp: 3600, color: 'var(--lv-vis)' }
    ];

    // Mapeamento de Elementos UI
    const UI = {
      loadingOverlay: document.getElementById('loadingOverlay'),
      viewLogin: document.getElementById('viewLogin'),
      viewDash: document.getElementById('viewDash'),
      viewQuiz: document.getElementById('viewQuiz'),
      viewConfig: document.getElementById('viewConfig'),
      viewRanking: document.getElementById('viewRanking'),
      
      inpName: document.getElementById('inpName'),
      btnGoogle: document.getElementById('btnGoogle'),
      btnLocal: document.getElementById('btnLocal'),
      
      userName: document.getElementById('userName'),
      userLevel: document.getElementById('userLevel'),
      xpCurrent: document.getElementById('xpCurrent'),
      xpFill: document.getElementById('xpFill'),
      statCompleted: document.getElementById('statCompleted'),
      statProgress: document.getElementById('statProgress'),
      statLevelBadge: document.getElementById('statLevelBadge'),
      
      modulesList: document.getElementById('modulesList'),
      navQuiz: document.getElementById('navQuiz'),
      
      quizModIcon: document.getElementById('quizModIcon'),
      quizModId: document.getElementById('quizModId'),
      quizModTitle: document.getElementById('quizModTitle'),
      quizStory: document.getElementById('quizStory'),
      quizQIndex: document.getElementById('quizQIndex'),
      quizQuestion: document.getElementById('quizQuestion'),
      quizOptions: document.getElementById('quizOptions'),
      quizFeedback: document.getElementById('quizFeedback'),
      quizFeedbackTitle: document.getElementById('quizFeedbackTitle'),
      quizFeedbackExp: document.getElementById('quizFeedbackExp'),
      btnQuizNext: document.getElementById('btnQuizNext'),
      btnQuizFinish: document.getElementById('btnQuizFinish'),
      
      btnSignOut: document.getElementById('btnSignOut'),
      btnReset: document.getElementById('btnReset'),
      configUserName: document.getElementById('configUserName'),
      currentPass: document.getElementById('currentPass'),
      rankBtn: document.getElementById('rankBtn'),
      rankBody: document.getElementById('rankBody'),
      btnBackFromRanking: document.getElementById('btnBackFromRanking')
    };
    
    // =========================================================================
    // BANCO DE DADOS (DB_MODULES)
    // =========================================================================

    const DB_MODULES = [
      // M√ìDULOS T√âCNICO
      { id: 1, title: 'LPS ‚Äî Last Planner System', icon: 'üéØ', level: 'T√©cnico' },
      { id: 2, title: 'Cronograma ‚Äî L√≥gica e EAP', icon: 'üóìÔ∏è', level: 'T√©cnico' },
      { id: 3, title: 'Programa√ß√£o Semanal (M. Curto Prazo)', icon: 'üìù', level: 'T√©cnico' },
      { id: 4, title: 'Folha Tarefa ‚Äî Ader√™ncia (PPC)', icon: '‚úÖ', level: 'T√©cnico' },
      { id: 5, title: 'Produtos Not√°veis (Produtividade)', icon: 'üìà', level: 'T√©cnico' },
      { id: 6, title: 'Painel de Bordo (Indicadores)', icon: 'üìä', level: 'T√©cnico' },
      { id: 7, title: 'Rundown / Curva S', icon: 'üìâ', level: 'T√©cnico' },
      { id: 8, title: '√çndices & Produtividade', icon: 'üè≠', level: 'T√©cnico' },
      { id: 9, title: 'Reuni√µes Lean (Daily Meeting)', icon: 'ü§ù', level: 'T√©cnico' },
      { id: 10, title: 'Restri√ß√µes e Lookahead', icon: 'üöß', level: 'T√©cnico' },
      { id: 11, title: 'Waste Time (Perda de Tempo)', icon: '‚è±Ô∏è', level: 'T√©cnico' },
      { id: 12, title: 'As-Built e Fechamento', icon: 'üèóÔ∏è', level: 'T√©cnico' },
      
      // M√ìDULOS ANALISTA
      { id: 13, title: 'Linha de Produ√ß√£o na Obra (Lean aplicado)', icon: 'üî•', level: 'Analista' },
      { id: 14, title: 'Alinhamento Engenharia x Planejamento', icon: 'üß©', level: 'Analista' },
      { id: 15, title: 'Produtividade e Efetivo (An√°lise cr√≠tica)', icon: 'üöÄ', level: 'Analista' },
      { id: 16, title: 'Cadeia de Suprimentos', icon: 'üîó', level: 'Analista' },
      { id: 17, title: 'Equipamentos e Log√≠stica (Gruas, Guindastes)', icon: '‚öôÔ∏è', level: 'Analista' },
      { id: 18, title: 'Inspe√ß√µes, Qualidade e Testes', icon: 'üîç', level: 'Analista' },
      { id: 19, title: 'Integra√ß√£o com Seguran√ßa', icon: 'üî•', level: 'Analista' },
      { id: 20, title: 'Comissionamento e Entrega', icon: '‚ö°', level: 'Analista' },

      // M√ìDULOS ESPECIALISTA
      { id: 21, title: 'Gest√£o de Interfaces entre Disciplinas', icon: 'üü£', level: 'Especialista' },
      { id: 22, title: 'Planejamento Integrado com BIM (4D)', icon: 'üß©', level: 'Especialista' },
      { id: 23, title: 'Planejamento de Grandes Paradas (Shutdowns)', icon: '‚öôÔ∏è', level: 'Especialista' },
      { id: 24, title: 'Log√≠stica Avan√ßada de Campo', icon: 'üöö', level: 'Especialista' },
      { id: 25, title: 'An√°lise de Desempenho com Dados (KPIs avan√ßados)', icon: 'üìä', level: 'Especialista' },
      { id: 26, title: 'Gest√£o de Mudan√ßas (Change Management)', icon: 'üîÑ', level: 'Especialista' },
      { id: 27, title: 'Curva de Aprendizado (Learning Curve)', icon: 'üî¨', level: 'Especialista' },
      { id: 28, title: 'Resolu√ß√£o de Problemas (Lean PDCA / 5 Porqu√™s)', icon: 'üß†', level: 'Especialista' },
      { id: 29, title: 'Planejamento Orientado ao Cliente (VOE ‚Äî Valor)', icon: 'üèóÔ∏è', level: 'Especialista' },
      { id: 30, title: 'Controle em Tempo Real (Live-Data Planning)', icon: 'üõ∞Ô∏è', level: 'Especialista' },

      // M√ìDULOS GERENTE / DIRETOR
      { id: 31, title: 'Lideran√ßa no Planejamento', icon: 'üëî', level: 'Gerente/Diretor' },
      { id: 32, title: 'Gest√£o de Custos & Or√ßamento', icon: 'üí∞', level: 'Gerente/Diretor' },
      { id: 33, title: 'Gest√£o de Riscos', icon: '‚ö†Ô∏è', level: 'Gerente/Diretor' },
      { id: 34, title: 'Comunica√ß√£o Executiva', icon: 'üéØ', level: 'Gerente/Diretor' },
      { id: 35, title: 'AWP com Cronograma Integrado', icon: 'üßÆ', level: 'Gerente/Diretor' },
      { id: 36, title: 'Tomada de Decis√£o Estrat√©gica', icon: 'üß®', level: 'Gerente/Diretor' },

      // M√ìDULOS VISION√ÅRIO
      { id: 37, title: 'Intelig√™ncia Artificial na Obra', icon: 'ü§ñ', level: 'Vision√°rio' },
      { id: 38, title: 'Planejamento 5D (Custo + Prazo + Modelo)', icon: 'üõ∞Ô∏è', level: 'Vision√°rio' },
      { id: 39, title: 'Power BI e Dashboards Integrados', icon: 'üì°', level: 'Vision√°rio' },
      { id: 40, title: 'Planejamento Baseado em Simula√ß√µes', icon: 'üß¨', level: 'Vision√°rio' },
    ];
    
    // =========================================================================
    // BANCO DE DADOS (DB_QUIZ) - COM AS 40 QUEST√ïES CORRIGIDAS
    // =========================================================================
    
    const TEC_IDS = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
    
    const DB_QUIZ = {
      // MOD 1: LPS
      1: [
        {q:'Qual o principal objetivo do PPC?',opts:['Medir lucro financeiro','Medir ader√™ncia do planejado x realizado','Medir satisfa√ß√£o do cliente'],ok:1,exp:'PPC (Percent Plan Complete) mede quantos pacotes foram conclu√≠dos conforme prometido na semana.'},
        {q:'Quem s√£o os Last Planners (√öltimos Planejadores)?',opts:['Gerentes de Contrato','Diretores da empresa','Encarregados e l√≠deres de frente'],ok:2,exp:'S√£o as pessoas que est√£o na ponta da execu√ß√£o e definem o que realmente ser√° feito.'},
        {q:'A base do plano semanal deve conter:',opts:['Todas as atividades do cronograma','Somente atividades prontas e liberadas','Atividades que est√£o atrasadas, mesmo sem material'],ok:1,exp:'No LPS, s√≥ entra na semana o que tem restri√ß√£o removida e recurso dispon√≠vel.'},
        {q:'O que fazer com restri√ß√µes identificadas?',opts:['Ignorar e seguir','Deixar para resolver no dia','Tratar antes de planejar a execu√ß√£o'],ok:2,exp:'Restri√ß√µes (projetos, materiais, acesso) devem ser removidas no Lookahead, antes da semana.'},
        {q:'Como devem ser as reuni√µes do LPS?',opts:['Longas e detalhadas','Dailys r√°pidas e objetivas','Mensais com diretoria'],ok:1,exp:'Foco em alinhamento r√°pido, confirma√ß√£o de metas e remo√ß√£o de travas.'},
        {q:'O que um PPC baixo recorrente indica?',opts:['Equipe trabalhando muito','Falhas no planejamento ou restri√ß√µes n√£o tratadas','Sucesso do projeto'],ok:1,exp:'Indica instabilidade e falta de confiabilidade no sistema.'},
        {q:'Quem deve preencher a Folha Tarefa?',opts:['O estagi√°rio na sala t√©cnica','Encarregados / L√≠deres de campo','O cliente'],ok:1,exp:'Quem executa sabe o que foi feito. O preenchimento deve ser na ponta.'},
        {q:'ICP e IPP medem principalmente:',opts:['Causas de falha e √≠ndice de prontid√£o','Lucro e Preju√≠zo','Temperatura do ambiente'],ok:0,exp:'√çndices de Confiabilidade e Prontid√£o ajudam a diagnosticar a sa√∫de do fluxo.'}
      ],
      // MOD 2: CRONOGRAMA
      2: [
        {q:'O Caminho Cr√≠tico √© a sequ√™ncia de atividades que:',opts:['Tem maior custo','N√£o tem folga (determina o prazo final)','√â mais f√°cil de fazer'],ok:1,exp:'Qualquer atraso no caminho cr√≠tico impacta a entrega da obra.'},
        {q:'Para que serve a EAP (Estrutura Anal√≠tica do Projeto)?',opts:['Organizar entreg√°veis em pacotes','Calcular fluxo de caixa','Definir quem √© o chefe'],ok:0,exp:'Decomp√µe o escopo total em partes gerenci√°veis.'},
        {q:'Qual a melhor forma de controlar o avan√ßo f√≠sico?',opts:['Perguntar ao mestre','Curva S com pesos ponderados','Verificar nota fiscal'],ok:1,exp:'A Curva S f√≠sica compara o planejado x realizado baseado no peso de cada atividade.'},
        {q:'Para usar √≠ndices de produtividade, √© preciso ter:',opts:['Quantidades detalhadas e confi√°veis','Apenas o valor total do contrato','Muitos engenheiros'],ok:0,exp:'Sem a quantidade exata (m¬≥, ton, m), o √≠ndice n√£o reflete a realidade.'},
        {q:'A sequ√™ncia l√≥gica do cronograma deve considerar:',opts:['Apenas o desejo do cliente','Interfer√™ncias reais e construtibilidade','A ordem alfab√©tica'],ok:1,exp:'N√£o adianta planejar solda antes da pr√©-montagem (erro de l√≥gica).'},
        {q:'Quando se deve reprogramar (Baseline)?',opts:['Toda semana','Nunca','Quando h√° desvio que afeta o prazo final irreversivelmente'],ok:2,exp:'Mudan√ßa de linha de base deve ser criteriosa para n√£o perder o hist√≥rico.'},
        {q:'A Linha de Base (Baseline) serve para:',opts:['Bonificar a equipe','Comparar varia√ß√µes (Previsto x Real)','Travar o software'],ok:1,exp:'√â a refer√™ncia congelada do plano original.'},
        {q:'A dura√ß√£o correta de uma tarefa depende de:',opts:['Chute do gerente','√çndice de produtividade e quantidade a executar','Data que o cliente quer'],ok:1,exp:'Dura√ß√£o = Quantidade x √çndice / Recursos.'}
      ],
      // MOD 3: PROGRAMA√á√ÉO SEMANAL
      3: [
        {q:'Quem deve planejar a semana de trabalho?',opts:['O planejador sozinho','Os Last Planners (Executores)','O diretor'],ok:1,exp:'Planejamento colaborativo garante compromisso real.'},
        {q:'Uma atividade programada e n√£o conclu√≠da vira:',opts:['Um problema esquecido','WNC (Why Not Completed) / Causa Raiz','Hora extra autom√°tica'],ok:1,exp:'Deve-se analisar o motivo do n√£o cumprimento para n√£o repetir o erro.'},
        {q:'O plano semanal precisa garantir:',opts:['Recursos + Frente Liberada + Sem restri√ß√µes','Apenas vontade de fazer','M√°ximo de atividades poss√≠vel'],ok:0,exp:'S√≥ se promete o que se pode cumprir (Confiabilidade).'},
        {q:'Como definir a prioridade das equipes?',opts:['Quem gritar mais alto','Caminho cr√≠tico e gargalos de produ√ß√£o','Sorteio'],ok:1,exp:'Focar no que libera as pr√≥ximas etapas ou impacta o prazo final.'},
        {q:'O que um PPC baixo na semana indica?',opts:['Chuva excessiva sempre','Falhas de fluxo e libera√ß√£o de servi√ßo','Azar'],ok:1,exp:'Geralmente mostra que enviamos trabalho com restri√ß√£o para o campo.'},
        {q:'Qual a ferramenta de controle di√°rio do plano semanal?',opts:['E-mail','Folha Tarefa / Di√°rio de Obra','WhatsApp'],ok:1,exp:'Registro formal do que foi feito vs planejado dia a dia.'},
        {q:'Qual a dura√ß√£o ideal do plano de curto prazo?',opts:['1 m√™s','Apenas a semana (ou quinzena)','1 ano'],ok:1,exp:'Foco total na execu√ß√£o imediata com alta precis√£o.'},
        {q:'Qual t√©cnica Lean √© aplicada na programa√ß√£o semanal?',opts:['Empurrar produ√ß√£o','Pull Planning (Puxar produ√ß√£o)','Estoque infinito'],ok:1,exp:'Produzir o que a pr√≥xima etapa precisa, quando precisa.'}
      ],
      // MOD 4: FOLHA TAREFA
      4: [
        {q:'Qual o objetivo principal da Folha Tarefa?',opts:['Gerar papelada','Confirmar execu√ß√£o di√°ria e alimentar o PPC','Vigiar hor√°rio de almo√ßo'],ok:1,exp:'√â o documento que traz a verdade do campo para o planejamento.'},
        {q:'Quem valida as informa√ß√µes da Folha Tarefa?',opts:['O porteiro','Encarregado da frente + Planejamento','O fornecedor'],ok:1,exp:'Valida√ß√£o conjunta garante que o dado √© real.'},
        {q:'Qual a causa mais comum de queda no PPC vista na folha?',opts:['Falta de material ou frente impedida','Falta de caf√©','Excesso de sol'],ok:0,exp:'Restri√ß√µes f√≠sicas s√£o os maiores vil√µes da produtividade.'},
        {q:'Muitos itens "Vermelhos" (n√£o feitos) na folha indicam:',opts:['Equipe pregui√ßosa','Falhas de fluxo e libera√ß√£o de servi√ßo','Nada de mais'],ok:1,exp:'Sinaliza que o plano enviado n√£o estava pronto para ser executado.'},
        {q:'Se houve atraso no dia, o que deve ser registrado?',opts:['Uma desculpa','A Causa Raiz real','Nada'],ok:1,exp:'Sem registrar a causa, n√£o conseguimos aplicar melhoria cont√≠nua.'},
        {q:'Qual o resultado principal da boa gest√£o da Folha Tarefa?',opts:['Ader√™ncia di√°ria e confiabilidade dos dados','Aumento de reuni√µes','Mais burocracia'],ok:0,exp:'Permite agir r√°pido corrigindo desvios.'},
        {q:'Quando a Folha Tarefa deve ser atualizada?',opts:['No final do m√™s','No in√≠cio (check-in) e fim do dia (check-out)','Quando der tempo'],ok:1,exp:'Gest√£o em tempo real (ou D-1) √© essencial.'},
        {q:'Qual a liga√ß√£o da Folha Tarefa com o LPS?',opts:['Nenhuma','Ajuste imediato no plano e c√°lculo do PPC','Serve para demitir'],ok:1,exp:'Ela √© o instrumento de coleta do Percent Plan Complete.'}
      ],
      // MOD 5: PRODUTIVIDADE (PRODUTOS NOT√ÅVEIS)
      5: [
        {q:'Para que √© utilizado o √çndice de Produtividade (RUP)?',opts:['Para pagar sal√°rios','Planejar horas necess√°rias e medir efici√™ncia','Para comprar EPI'],ok:1,exp:'Ajuda a dimensionar equipes e prever prazos.'},
        {q:'Se o √≠ndice est√° piorando (aumentando HH/unidade), indica:',opts:['Equipe r√°pida','Gargalos, retrabalho ou perda de efici√™ncia','Sucesso'],ok:1,exp:'Gastando mais horas para fazer a mesma quantidade.'},
        {q:'O que causa baixa produtividade mesmo com equipe cheia?',opts:['Falta de motiva√ß√£o apenas','Restri√ß√£o n√£o tratada (material, acesso, projeto)','Muito feriado'],ok:1,exp:'Gente parada esperando recurso destr√≥i a produtividade.'},
        {q:'Como s√£o calculadas as horas previstas?',opts:['Quantidade a fazer x √çndice or√ßado','Quantidade x Pre√ßo','Chute'],ok:0,exp:'Ex: 100m x 0,5hh/m = 50hh previstas.'},
        {q:'Qual a melhor forma de acompanhamento visual?',opts:['Planilha oculta','Dashboard de produtividade compartilhado','E-mail longo'],ok:1,exp:'O time precisa ver se est√° ganhando ou perdendo o jogo.'},
        {q:'As condi√ß√µes de campo (chuva, altura, acesso) influenciam o √≠ndice?',opts:['N√£o, o √≠ndice √© fixo','Sim, muito','Pouco'],ok:1,exp:'Trabalho em altura ou confinado √© sempre menos produtivo que no solo.'},
        {q:'Qual a melhor a√ß√£o para recuperar um √≠ndice ruim?',opts:['Contratar mais gente sem an√°lise','Reduzir movimenta√ß√£o, esperas e remover travas','Gritar com a equipe'],ok:1,exp:'Lean: eliminar desperd√≠cios para que o trabalho flua.'},
        {q:'Qual √°rea costuma ter maior varia√ß√£o de produtividade?',opts:['Pintura de parede','Tubula√ß√£o/Montagem em altura ou Pipe-rack','Limpeza'],ok:1,exp:'A complexidade de acesso e log√≠stica impacta muito a montagem industrial.'}
      ],
      // MOD 6: PAINEL DE BORDO
      6: [
        {q:'Qual o principal indicador do avan√ßo da obra?',opts:['Valor gasto','% F√≠sico Real x Planejado (Curva S)','N√∫mero de e-mails'],ok:1,exp:'Mostra se a obra est√° andando na velocidade correta.'},
        {q:'O Painel de Bordo (Dashboard) deve ser:',opts:['Complexo e cheio de texto','Simples, objetivo e visual','Apenas para o gerente'],ok:1,exp:'Deve permitir entender o status em 5 segundos.'},
        {q:'O painel deve integrar quais indicadores?',opts:['Apenas financeiro','Produtividade, PPC, Curva S e Restri√ß√µes','Aniversariantes do m√™s'],ok:1,exp:'Vis√£o 360¬∫: Prazo, Efici√™ncia e Confiabilidade.'},
        {q:'Qual a frequ√™ncia m√≠nima de atualiza√ß√£o do painel?',opts:['Mensal','Semanal (idealmente di√°ria para alguns KPIs)','Anual'],ok:1,exp:'Informa√ß√£o velha n√£o serve para tomada de decis√£o.'},
        {q:'Para que serve o painel de bordo?',opts:['Decora√ß√£o','Tomada de decis√£o baseada em dados','Impressionar visitas'],ok:1,exp:'Transformar dados em a√ß√£o corretiva.'},
        {q:'A transpar√™ncia dos dados no painel gera:',opts:['Medo','Alinhamento e engajamento do time','Confus√£o'],ok:1,exp:'Todos sabem onde est√£o os problemas e podem ajudar.'},
        {q:'Qual o melhor local para o painel?',opts:['Gaveta do gerente','√Årea comum da equipe (Obra ou Sala T√©cnica)','Arquivo morto'],ok:1,exp:'Gest√£o √† Vista deve estar... √† vista.'},
        {q:'O que facilita a leitura r√°pida do painel?',opts:['Textos longos','Codifica√ß√£o de cores (Verde/Amarelo/Vermelho)','Fontes pequenas'],ok:1,exp:'Semaforiza√ß√£o indica onde precisa de aten√ß√£o imediata.'}
      ],
      // MOD 7: RUNDOWN
      7: [
        {q:'O que a Curva S mostra?',opts:['Acumulado de Planejado vs Realizado ao longo do tempo','Apenas o custo mensal','O estoque de material'],ok:0,exp:'Permite ver a tend√™ncia de atraso ou adiantamento.'},
        {q:'Para que serve o gr√°fico de Rundown?',opts:['Mostrar o saldo restante (queima de estoque/tarefas)','Mostrar o lucro','Mostrar efetivo'],ok:0,exp:'Visualiza quanto falta fazer para zerar o escopo.'},
        {q:'Um "Gap negativo" entre as curvas indica:',opts:['Lucro','Atraso (Realizado abaixo do Planejado)','Adiantamento'],ok:1,exp:'A obra entregou menos do que deveria at√© a data.'},
        {q:'Se a Curva Real est√° ACIMA da Planejada, significa:',opts:['Adiantamento (mas aten√ß√£o √† sequ√™ncia)','Preju√≠zo','Erro de sistema'],ok:0,exp:'Entregou mais volume que o previsto (necess√°rio checar se foi no caminho cr√≠tico).'},
        {q:'Quem √© o respons√°vel principal por gerar esses gr√°ficos?',opts:['Suprimentos','Planejamento e Controle','RH'],ok:1,exp:'O setor de Planejamento consolida os dados de avan√ßo.'},
        {q:'Qual a primeira a√ß√£o ao detectar atraso na Curva S?',opts:['Desistir','Analisar causas e replanejar frentes (Plano de A√ß√£o)','Esconder o gr√°fico'],ok:1,exp:'Identificar onde descolou e agir para recuperar.'},
        {q:'Qual o dado base para a Curva S F√≠sica?',opts:['Dinheiro gasto','Pesos ponderados ou Quantidades conclu√≠das','Horas extras'],ok:1,exp:'Reflete o avan√ßo t√©cnico da obra, n√£o o financeiro.'},
        {q:'O Rundown ajuda a estabelecer:',opts:['Metas semanais para recuperar o atraso','Feriados','Sal√°rios'],ok:0,exp:'"Para acabar no prazo, preciso fazer X unidades por semana a partir de agora".'}
      ],
      // MOD 8: √çNDICES
      8: [
        {q:'A produtividade √© definida matematicamente como:',opts:['Sorte x Vontade','Output (Produ√ß√£o) / Input (Recurso/Horas)','Dinheiro / Tempo'],ok:1,exp:'Exemplo: M¬≤ pintados dividido por Homem-hora gasto.'},
        {q:'Os √≠ndices hist√≥ricos ajudam a:',opts:['Simular cen√°rios futuros com precis√£o','Fazer festas','Nada'],ok:0,exp:'Usar dados de obras passadas melhora a assertividade das novas.'},
        {q:'Quem √© o pior vil√£o da produtividade no campo?',opts:['Chuva','Deslocamento excessivo e espera (Ociosidade)','Ferramentas novas'],ok:1,exp:'Tempo gasto andando ou esperando n√£o agrega valor.'},
        {q:'Qual indicador est√° diretamente ligado √† produtividade?',opts:['HH por unidade (Raz√£o Unit√°ria)','Taxa de juros','Pre√ßo do a√ßo'],ok:0,exp:'Mede o esfor√ßo necess√°rio para produzir uma unidade.'},
        {q:'Melhorar o fluxo de trabalho faz:',opts:['A produtividade subir','A produtividade cair','Nada acontecer'],ok:0,exp:'Fluxo cont√≠nuo sem paradas √© o segredo da alta performance.'},
        {q:'A medi√ß√£o di√°ria de produ√ß√£o permite:',opts:['Ajuste r√°pido de rota','Apenas registro hist√≥rico','Burocracia'],ok:0,exp:'N√£o espere o fim do m√™s para descobrir que a meta n√£o foi batida.'},
        {q:'Existem √≠ndices "fixos" universais?',opts:['Sim, toda obra √© igual','N√£o, variam conforme condi√ß√µes de campo e complexidade','Sim, tabela SINAPI √© absoluta'],ok:1,exp:'Cada obra tem sua log√≠stica, clima e especificidade.'},
        {q:'Para ser confi√°vel, a medi√ß√£o de campo deve ser:',opts:['Frequente, criteriosa e validada','Feita por estimativa','Feita do escrit√≥rio'],ok:0,exp:'Dados ruins geram decis√µes ruins (GIGO).'}
      ],
      // MOD 9: REUNI√ïES LEAN
      9: [
        {q:'Uma Reuni√£o Lean deve ser:',opts:['Longa e detalhada','Objetiva, r√°pida e com prop√≥sito claro','Um mon√≥logo do chefe'],ok:1,exp:'Foco em resolu√ß√£o de problemas e alinhamento.'},
        {q:'Qual o tempo m√°ximo recomendado para reuni√µes di√°rias (Dailys)?',opts:['1 hora','15 minutos (em p√©)','30 segundos'],ok:1,exp:'Stand-up meetings devem ser curtas para n√£o travar a equipe.'},
        {q:'Quem deve participar das reuni√µes de programa√ß√£o?',opts:['Apenas diretores','L√≠deres da execu√ß√£o (Encarregados/Mestres)','Fornecedores de caf√©'],ok:1,exp:'Quem vai executar precisa estar no acordo.'},
        {q:'O PPC deve ser exibido na reuni√£o?',opts:['N√£o, √© segredo','Sim, sempre, para gerar transpar√™ncia','Talvez'],ok:1,exp:'O time precisa saber se cumpriu o combinado da semana anterior.'},
        {q:'O termo "Gemba" significa:',opts:['Escrit√≥rio central','Ir ao local onde as coisas acontecem (Campo)','Sala de reuni√£o'],ok:1,exp:'Gest√£o real se faz vendo o problema no local.'},
        {q:'Para que serve o quadro visual na reuni√£o?',opts:['Alinhamento imediato de todos','Decorar a parede','Esconder problemas'],ok:0,exp:'Facilita que todos vejam as mesmas prioridades e restri√ß√µes.'},
        {q:'O que se deve evitar em reuni√µes de produ√ß√£o?',opts:['Resolver problemas','Burocracia excessiva e conversas paralelas','Definir metas'],ok:1,exp:'Foco no plano e nas restri√ß√µes.'},
        {q:'Qual o resultado esperado de uma boa reuni√£o semanal?',opts:['Ata assinada apenas','Plano de trabalho ajustado e compromissos firmados','Cansa√ßo'],ok:1,exp:'Todos saem sabendo o que devem fazer na semana.'}
      ],
      // MOD 10: RESTRI√á√ïES
      10: [
        {q:'O que √© uma Restri√ß√£o no planejamento?',opts:['Uma regra do governo','Algo que impede o in√≠cio ou continuidade de uma tarefa','Um erro de projeto'],ok:1,exp:'Falta de material, projeto, acesso, equipamento, libera√ß√£o.'},
        {q:'Onde as restri√ß√µes devem ser registradas?',opts:['Na cabe√ßa do engenheiro','Em planilha de controle ou gest√£o visual (Lookahead)','No di√°rio oficial'],ok:1,exp:'Deve ser monitorada at√© ser eliminada.'},
        {q:'Qual o momento ideal para tratar uma restri√ß√£o?',opts:['No dia da execu√ß√£o','Antes de planejar a atividade para a semana (M√©dio Prazo)','Depois que parou a obra'],ok:1,exp:'Antecipar problemas √© a ess√™ncia do Lookahead.'},
        {q:'S√£o exemplos de restri√ß√µes t√≠picas:',opts:['Material, Seguran√ßa, Projetos/Engenharia, Acesso','Chuva e Sol','Feriados'],ok:0,exp:'Itens que bloqueiam a produ√ß√£o.'},
        {q:'Uma restri√ß√£o de material recorrente (RNC) indica:',opts:['Azar','Falha no fluxo de suprimentos ou log√≠stica','Problema do fornecedor apenas'],ok:1,exp:'Exige an√°lise de causa raiz no processo de compras/entrega.'},
        {q:'O planejamento deve fazer o que com atividades restritas?',opts:['Colocar na meta para pressionar','Bloquear sua ida para o plano semanal','Ignorar'],ok:1,exp:'Nunca envie servi√ßo travado para o campo (gera improdutividade).'},
        {q:'Quem √© o "Dono" da restri√ß√£o?',opts:['Sempre o gerente','Quem tem o poder de elimin√°-la (ex: Suprimentos para material)','O estagi√°rio'],ok:1,exp:'Cada restri√ß√£o deve ter um respons√°vel e um prazo.'},
        {q:'Qual a frequ√™ncia de acompanhamento das restri√ß√µes?',opts:['Mensal','Di√°ria ou Semanal (no Lookahead)','Anual'],ok:1,exp:'As travas precisam ser removidas constantemente.'}
      ],
      // MOD 11: WASTE TIME
      11: [
        {q:'O que o indicador "Waste Time" mede?',opts:['Tempo de descanso','Horas desperdi√ßadas / improdutivas','Tempo de chuva'],ok:1,exp:'Mede o tempo pago que n√£o gerou produ√ß√£o (esperas, falhas).'},
        {q:'Uma causa t√≠pica de Waste Time √©:',opts:['Espera por interfer√™ncia ou material','Trabalhar r√°pido demais','Pausa para √°gua'],ok:0,exp:'Equipe parada aguardando libera√ß√£o √© desperd√≠cio puro.'},
        {q:'Waste Time est√° ligado a qual conceito?',opts:['PMBOK','Lean Construction e elimina√ß√£o de desperd√≠cios','Norma NR-10'],ok:1,exp:'Lean foca em criar fluxo e eliminar o que n√£o agrega valor.'},
        {q:'Onde registrar as ocorr√™ncias de perda de tempo?',opts:['Em lugar nenhum','No apontamento/Dashboard semanal','No Facebook'],ok:1,exp:'Para combater, precisamos medir e tipificar as perdas.'},
        {q:'A redu√ß√£o do Waste Time impacta diretamente:',opts:['Aumenta a Produtividade','Aumenta o Custo','Atrasa a obra'],ok:0,exp:'Menos tempo perdido = Mais tempo produzindo.'},
        {q:'Movimenta√ß√£o excessiva de pessoas √© classificada como:',opts:['Exerc√≠cio f√≠sico','Categoria de desperd√≠cio (Waste)','Necess√°rio'],ok:1,exp:'Layout ruim obriga o funcion√°rio a andar em vez de trabalhar.'},
        {q:'Qual a meta ideal para "esperas" na obra?',opts:['10%','Zero espera','50%'],ok:1,exp:'A perfei√ß√£o √© o fluxo cont√≠nuo (embora dif√≠cil, √© o norte).'}
      ],
      // MOD 12: AS-BUILT
      12: [
        {q:'O que o As-Built representa?',opts:['O projeto original','O que foi realmente executado (Como Constru√≠do)','O or√ßamento'],ok:1,exp:'Registra as altera√ß√µes e a realidade final da obra.'},
        {q:'O As-Built deve ser integrado com:',opts:['RH','Engenharia e Controle de Qualidade','Marketing'],ok:1,exp:'Garante que a documenta√ß√£o t√©cnica reflete o campo.'},
        {q:'Qual o prazo ideal para registrar o As-Built?',opts:['No final da obra','Semanalmente ou conforme a execu√ß√£o avan√ßa','Nunca'],ok:1,exp:'Deixar para o final gera esquecimento e perda de informa√ß√µes.'},
        {q:'A falta de As-Built gera risco de:',opts:['Economia','Retrabalho futuro e problemas de manuten√ß√£o','Adiantamento'],ok:1,exp:'Furar um tubo que "n√£o deveria estar ali" √© um cl√°ssico.'},
        {q:'O As-Built ajuda muito em qual fase futura?',opts:['Mobiliza√ß√£o','Comissionamento e Opera√ß√£o','Or√ßamento inicial'],ok:1,exp:'A equipe de startup precisa saber exatamente o que est√° instalado.'},
        {q:'Uma boa pr√°tica para As-Built √©:',opts:['Marca√ß√£o visual em planta (Red lines) por cores','Apenas fotos','Memorizar'],ok:0,exp:'Manter as plantas de campo marcadas (caneta vermelha) atualizadas.'},
        {q:'O resultado final do As-Built √©:',opts:['Um desenho bonito','Documento t√©cnico confi√°vel para o cliente (Data Book)','Lixo'],ok:1,exp:'Faz parte da entrega formal do ativo.'}
      ],
      
      // =======================
      // N√çVEL ANALISTA (13-20)
      // =======================
      
      // MOD 13: Linha de Produ√ß√£o na Obra (Lean aplicado)
      13: [
        {q:'Linha de produ√ß√£o significa:',opts:['Fluxo cont√≠nuo e previs√≠vel','Produzir o m√°ximo poss√≠vel','Estoque alto no canteiro'],ok:0,exp:'O foco do Lean √© o fluxo cont√≠nuo e a estabilidade.'},
        {q:'Qual o maior vil√£o do fluxo cont√≠nuo?',opts:['Reuni√µes curtas','Interrup√ß√µes e movimenta√ß√£o desnecess√°ria','Muitos engenheiros'],ok:1,exp:'Interrup√ß√µes (paradas, esperas) e movimenta√ß√£o s√£o desperd√≠cios (Mudas).'},
        {q:'O conceito Takt na constru√ß√£o √©:',opts:['A velocidade da chuva','Ritmo ideal de produ√ß√£o exigido pelo cliente','Custo di√°rio'],ok:1,exp:'Define o ritmo que a obra precisa ter para terminar no prazo, trabalhando de forma sustent√°vel.'},
        {q:'Work in Progress (WIP) alto indica:',opts:['Produtividade alta','Ac√∫mulo de trabalho sem entrega final','Equipe motivada'],ok:1,exp:'WIP alto aumenta a complexidade, a chance de erros e atrasa a entrega de valor.'},
        {q:'O balanceamento de linha evita:',opts:['M√£o de obra ociosa','Gargalos e subutiliza√ß√£o de recursos','Desperd√≠cio'],ok:1,exp:'Balancear garante que todas as etapas t√™m capacidade para absorver o volume da etapa anterior, evitando gargalos.'},
        {q:'Fluxo em U (layout) facilita:',opts:['Aumento de custos','Entrega, supervis√£o e redu√ß√£o de movimenta√ß√£o','Mais burocracia'],ok:1,exp:'Otimiza o transporte e a comunica√ß√£o entre as frentes.'},
        {q:'Para manter o fluxo cont√≠nuo, √© fundamental:',opts:['Aumentar o estoque','Remover restri√ß√µes e garantir recursos','Pressionar a equipe'],ok:1,exp:'O fluxo s√≥ acontece se as atividades estiverem preparadas para iniciar (sem travas).'},
        {q:'Os indicadores que melhor refletem a sa√∫de do fluxo s√£o:',opts:['Apenas o custo','PPC (Confiabilidade) + Produtividade (Efici√™ncia)','N√∫mero de reclama√ß√µes'],ok:1,exp:'PPC e produtividade mostram se o combinado est√° sendo cumprido com efici√™ncia.'}
      ],
      // MOD 14: Alinhamento Engenharia x Planejamento
      14: [
        {q:'O principal papel da Engenharia no planejamento √©:',opts:['Fazer a compra de material','Fornecer informa√ß√µes completas (projetos) no tempo certo','Apenas fiscalizar a obra'],ok:1,exp:'O planejamento √© ref√©m da informa√ß√£o de engenharia (projetos, isom√©tricos, lista de materiais).'},
        {q:'A falta de detalhamento ou especifica√ß√£o gera o que para o Planejamento?',opts:['Adiantamento','Restri√ß√£o e inviabilidade de execu√ß√£o','Melhoria de custo'],ok:1,exp:'Sem informa√ß√£o detalhada, a atividade n√£o pode ser liberada (restri√ß√£o de engenharia).'},
        {q:'Qual documento essencial a Engenharia deve liberar com anteced√™ncia?',opts:['Apenas o desenho 2D','Lista de materiais (LM) e desenhos revisados','O cronograma do cliente'],ok:1,exp:'A LM √© crucial para que o Suprimentos comece a agir e o Planejamento calcule o efetivo.'},
        {q:'A sequ√™ncia construtiva depende diretamente de:',opts:['Ordem alfab√©tica das disciplinas','Libera√ß√£o de projetos e interfaces','Disponibilidade de caf√©'],ok:1,exp:'N√£o adianta planejar solda antes da pr√©-montagem (erro de l√≥gica).'},
        {q:'Para garantir o alinhamento, a Engenharia deve:',opts:['Apenas enviar o projeto por e-mail','Participar ativamente no Pull Planning e Lookahead','N√£o se envolver com o campo'],ok:1,exp:'O di√°logo entre as √°reas √© vital para a construtibilidade.'},
        {q:'A melhor forma de evitar retrabalho causado pela Engenharia √©:',opts:['Fazer o projeto perfeito','Revisar interfaces e validar pacotes de trabalho conjuntamente','Culpar o campo'],ok:1,exp:'A valida√ß√£o cruzada pega erros l√≥gicos e de interfer√™ncia antes da execu√ß√£o.'},
        {q:'O controle de revis√µes (Versionamento) √©:',opts:['Desnecess√°rio','Indispens√°vel para garantir a rastreabilidade do projeto','S√≥ √∫til no final da obra'],ok:1,exp:'A constru√ß√£o deve usar a √∫ltima revis√£o validada. Erro de revis√£o √© erro cr√≠tico.'},
        {q:'O alinhamento constante entre as √°reas deve ser feito atrav√©s de:',opts:['Memorandos internos','Reuni√µes semanais integradas (Eng/Plan/Supr/Campo)','Reuni√µes anuais'],ok:1,exp:'A frequ√™ncia alta permite corrigir a rota antes que o problema se agrave.'}
      ],
      // MOD 15: Produtividade e Efetivo (An√°lise cr√≠tica)
      15: [
        {q:'Produtividade baixa com efetivo alto na frente de servi√ßo indica:',opts:['Efic√°cia na gest√£o','Falta de fluxo e coordena√ß√£o','Apenas mau tempo'],ok:1,exp:'Pessoas demais paradas/ociosas (Waste Time) esperando material ou recurso chave.'},
        {q:'Antes de aumentar o efetivo para ganhar prazo, voc√™ deve:',opts:['Contratar mais gente','Melhorar a produtividade do time atual e remover restri√ß√µes','Mudar o gerente'],ok:1,exp:'Se o fluxo √© ruim, mais gente s√≥ far√° mais gente ficar parada.'},
        {q:'O excesso de pessoas em uma frente de servi√ßo pequena pode causar:',opts:['Aumento da efici√™ncia','Aglomera√ß√£o, inseguran√ßa e interfer√™ncia','Produtividade m√°xima'],ok:1,exp:'Otimizar o n√∫mero para o tamanho do servi√ßo (Trabalho em Progresso Ideal).'},
        {q:'O principal indicador para an√°lise cr√≠tica de efetivo √©:',opts:['N√∫mero de reuni√µes','HH/Unidade (Raz√£o Unit√°ria) e produ√ß√£o di√°ria','Sal√°rio m√©dio'],ok:1,exp:'Mede a efici√™ncia real da equipe (quantas horas demoram para fazer uma unidade).'},
        {q:'Planejar a log√≠stica das frentes ajuda a evitar:',opts:['Trabalho','Deslocamento excessivo e espera por material','Otimismo'],ok:1,exp:'Reduzir a dist√¢ncia entre o estoque e o ponto de consumo √© ganho puro de HH.'},
        {q:'O efetivo ideal para uma obra √©:',opts:['O maior poss√≠vel','O m√≠nimo necess√°rio para manter o fluxo cont√≠nuo e a meta de produ√ß√£o','O n√∫mero or√ßado no projeto'],ok:1,exp:'Atingir a meta com a menor quantidade de esfor√ßo (Lean).'},
        {q:'Longa espera por equipamento (guindaste, munck) indica:',opts:['Boa gest√£o','M√° coordena√ß√£o e agendamento de recursos compartilhados','Equipe desmotivada'],ok:1,exp:'Ociosiade de pessoas √© um erro de planejamento de log√≠stica.'},
        {q:'O efetivo deve ser relacionado e validado com:',opts:['Apenas o RH','Curva S, PPC e as quantidades a produzir','Custo do aluguel'],ok:1,exp:'O efetivo tem que ser suficiente para cumprir o que a Curva S (Plano) exige e para manter o PPC alto.'}
      ],
      // MOD 16: Cadeia de Suprimentos
      16: [
        {q:'O papel principal da √°rea de Suprimentos √©:',opts:['Apenas achar o menor pre√ßo','Garantir materiais na hora certa (Data Necess√°ria da Obra)','Contratar o RH'],ok:1,exp:'O material que chega tarde bloqueia o caminho cr√≠tico.'},
        {q:'A integra√ß√£o de Suprimentos com o cronograma define:',opts:['A cor do capacete','A data de entrega necess√°ria na obra (DNO)','O tipo de solda'],ok:1,exp:'A DNO deve ser a base para a compra e o follow-up.'},
        {q:'O controle recomendado para rastrear o material √©:',opts:['Status de compras e datas de entregas confirmadas (Tracking)','Apenas o n√∫mero do pedido','O valor total gasto'],ok:0,exp:'Monitorar o pedido desde a emiss√£o at√© a chegada na obra (follow-up ativo).'},
        {q:'Material cr√≠tico √© aquele que:',opts:['√â muito caro','Impacta o caminho cr√≠tico e tem longo prazo de fabrica√ß√£o','√â importado'],ok:1,exp:'Atraso em material cr√≠tico significa atraso no prazo final da obra.'},
        {q:'Uma falha comum na gest√£o de materiais √©:',opts:['Planejar com anteced√™ncia','Pedido tardio ou sem detalhamento da Engenharia','Comprar em excesso'],ok:1,exp:'O planejamento da compra n√£o acompanhou o cronograma, gerando atraso na solicita√ß√£o.'},
        {q:'Quem sinaliza a urg√™ncia de um item para Suprimentos?',opts:['A diretoria','O Planejamento, com base no cronograma e Lookahead','O almoxarifado'],ok:1,exp:'O Planejamento √© a voz do campo e do prazo no processo de compra.'},
        {q:'O follow-up com o fornecedor deve ser:',opts:['Uma vez por m√™s','Semanal no m√≠nimo (ou di√°rio para itens cr√≠ticos)','No dia da entrega'],ok:1,exp:'O risco √© muito alto para confiar apenas no prazo inicial do pedido.'},
        {q:'O armazenamento incorreto do material no canteiro gera:',opts:['Facilidade na inspe√ß√£o','Perda, avaria e atraso na localiza√ß√£o/montagem','Economia'],ok:1,exp:'A log√≠stica de campo (Mod. 24) deve garantir a guarda e organiza√ß√£o.'}
      ],
      // MOD 17: Equipamentos e Log√≠stica (Gruas, Guindastes)
      17: [
        {q:'O i√ßamento de grandes pe√ßas exige:',opts:['For√ßa bruta','Planejamento detalhado, Rigger e An√°lise de Risco','Apenas um bom guindasteiro'],ok:1,exp:'√â uma atividade cr√≠tica que precisa de plano de i√ßamento e seguran√ßa.'},
        {q:'Uma interfer√™ncia a√©rea (opera√ß√£o de guindaste) costuma causar:',opts:['Felicidade','Parada total de outros servi√ßos (seguran√ßa)','Maior produtividade'],ok:1,exp:'Por seguran√ßa, todas as frentes sob o raio de giro precisam parar.'},
        {q:'A melhor programa√ß√£o de guindastes √© feita com:',opts:['Ordem de chegada','Janela exclusiva de tempo com libera√ß√£o de frente','Uso cont√≠nuo sem parar'],ok:1,exp:'Agendar o uso para minimizar o impacto nas frentes vizinhas (recurso compartilhado).'},
        {q:'O principal risco em uma opera√ß√£o de i√ßamento √©:',opts:['Atraso de 5 minutos','Queda, colis√£o e acidentes graves','Dificuldade na comunica√ß√£o'],ok:1,exp:'O risco √† seguran√ßa √© a prioridade zero.'},
        {q:'Um recurso compartilhado (como um guindaste) deve ter:',opts:['Apenas o custo registrado','Agendamento visual e claro para todas as frentes','Uso liberado a quem chegar primeiro'],ok:1,exp:'A transpar√™ncia na agenda evita conflitos e paradas (Gest√£o √† Vista).'},
        {q:'A produtividade da frente de montagem cai com:',opts:['Espera longa pelo guindaste','Equipe pequena e focada','Material no p√© do servi√ßo'],ok:0,exp:'Se o principal recurso (guindaste) est√° em espera, as pessoas ficam ociosas.'},
        {q:'Liberar a √°rea de i√ßamento significa:',opts:['Apenas isolar com fita','Garantir Seguran√ßa, sinaliza√ß√£o e comunica√ß√£o com frentes','Chamar o cliente'],ok:1,exp:'√â um conjunto de a√ß√µes para garantir que a opera√ß√£o ocorra sem incidentes.'},
        {q:'Qual disciplina deve ter prioridade no agendamento de equipamentos?',opts:['A mais f√°cil','As frentes cr√≠ticas (caminho cr√≠tico)','A mais suja'],ok:1,exp:'O foco deve estar no que define o prazo final da obra.'}
      ],
      // MOD 18: Inspe√ß√µes, Qualidade e Testes
      18: [
        {q:'A inspe√ß√£o de qualidade no campo garante:',opts:['Conformidade t√©cnica do servi√ßo e libera√ß√£o','Apenas o registro no sistema','Que o soldador √© bom'],ok:0,exp:'√â a verifica√ß√£o formal se o trabalho atende aos requisitos do projeto.'},
        {q:'Sem a libera√ß√£o do inspetor de qualidade (RTL), o que acontece?',opts:['O pr√≥ximo servi√ßo pode come√ßar','Nada avan√ßa e gera backlog','A obra adiantada'],ok:1,exp:'O pr√≥ximo servi√ßo que depende desse ponto de controle n√£o pode ser iniciado.'},
        {q:'O controle da inspe√ß√£o deve ser feito por:',opts:['Di√°rio de obra','Status visual (liberado, pendente, rejeitado) e rastreabilidade','Apenas e-mail'],ok:1,exp:'O Planejamento monitora o status de libera√ß√£o como uma restri√ß√£o.'},
        {q:'O retrabalho gerado por falha na qualidade acarreta:',opts:['Perda de prazo e custo adicional','Lucro','Aumento do efetivo'],ok:0,exp:'Retrabalho √© o pior dos desperd√≠cios, pois se gasta tempo e dinheiro corrigindo o que j√° devia estar pronto.'},
        {q:'Quem define os pontos de controle (PC) e testes essenciais?',opts:['O almoxarifado','Engenharia, Qualidade e a Norma T√©cnica','O Planejamento'],ok:1,exp:'√â um requisito t√©cnico definido no Plano de Inspe√ß√£o e Testes (PIT).'},
        {q:'Os testes hidrost√°ticos ou el√©tricos s√£o considerados:',opts:['Uma formality','Marco essencial de avan√ßo e libera√ß√£o','Uma perda de tempo'],ok:1,exp:'A conclus√£o bem-sucedida de um teste √© um marco de avan√ßo f√≠sico real.'},
        {q:'A documenta√ß√£o de inspe√ß√£o (Data Book) deve ser:',opts:['Feita com pressa','Completa, rastre√°vel e organizada','Apenas armazenada'],ok:1,exp:'√â a prova de que a obra foi constru√≠da conforme especificado.'},
        {q:'A entrega final da obra depende de:',opts:['Aprova√ß√£o visual','Punch list zerada (pend√™ncias resolvidas)','O desejo do cliente'],ok:1,exp:'O cliente s√≥ recebe o ativo quando todas as pend√™ncias (Punch) est√£o resolvidas.'}
      ],
      // MOD 19: Integra√ß√£o com Seguran√ßa
      19: [
        {q:'A Seguran√ßa deve vir antes de:',opts:['Custos','Execu√ß√£o de qualquer tarefa','Reuni√£o'],ok:1,exp:'O Planejamento n√£o pode liberar o que n√£o tem condi√ß√µes seguras para ser feito.'},
        {q:'A libera√ß√£o de trabalho (Permiss√£o de Trabalho) √©:',opts:['Uma etapa burocr√°tica','Condi√ß√£o necess√°ria e formal para o in√≠cio de servi√ßos de risco','Opicional'],ok:1,exp:'Sem PT/APR, o servi√ßo est√° bloqueado (restri√ß√£o de seguran√ßa).'},
        {q:'A An√°lise Preliminar de Risco (APR) deve:',opts:['Ser copiada da obra anterior','Antecipar riscos e definir medidas de controle','Apenas ser assinada'],ok:1,exp:'√â feita antes do in√≠cio para mapear e mitigar os perigos da atividade.'},
        {q:'O que acontece com o cronograma se a frente de trabalho est√° sem libera√ß√£o de Seguran√ßa?',opts:['O trabalho avan√ßa','A obra para (Seguran√ßa bloqueia a execu√ß√£o)','O planejamento √© refeito'],ok:1,exp:'O bloqueio por seguran√ßa √© inegoci√°vel.'},
        {q:'A integra√ß√£o da Seguran√ßa no Pull Planning e Lookahead permite:',opts:['Criar mais risco','Evitar retrabalho e paradas por falta de APR/PT','Deixar a responsabilidade s√≥ para o T√©cnico de Seguran√ßa'],ok:1,exp:'Planejar a Seguran√ßa junto com a produ√ß√£o √© o ideal.'},
        {q:'Um bom indicador de seguran√ßa para o Planejamento √©:',opts:['N√∫mero de treinamentos','Taxa de desvios/condi√ß√µes inseguras encontradas','N√∫mero de engenheiros'],ok:1,exp:'Mede a preven√ß√£o e o engajamento da equipe em evitar o risco.'},
        {q:'A √°rea de Seguran√ßa deve integrar com:',opts:['Apenas o RH','Todas as frentes e disciplinas da obra','O financeiro'],ok:1,exp:'O risco existe em toda a obra, a integra√ß√£o √© total.'},
        {q:'O objetivo final da integra√ß√£o Planejamento/Seguran√ßa √©:',opts:['Aumentar o prazo','Zero incidente e garantir o fluxo de trabalho','C√¢mera de seguran√ßa'],ok:1,exp:'Seguran√ßa √© condi√ß√£o para a produtividade e a sa√∫de do projeto.'}
      ],
      // MOD 20: Comissionamento e Entrega
      20: [
        {q:'O Comissionamento √© a fase que garante:',opts:['Apenas a limpeza da obra','O sistema funcionando conforme especificado (Startup)','O pagamento do contrato'],ok:1,exp:'√â a prova final de que todos os subsistemas interagem e operam.'},
        {q:'O Pr√©-comissionamento exige que:',opts:['O cliente esteja presente','Todos os sistemas interligados e testados individualmente','Apenas 50% da obra esteja pronta'],ok:1,exp:'Verifica a integridade e prontid√£o do sistema antes do teste final.'},
        {q:'Quem coordena a fase de Comissionamento?',opts:['O RH','O Planejamento em conjunto com a equipe de Comissionamento/Opera√ß√£o','A Engenharia'],ok:1,exp:'O Planejamento atua como PMO, integrando e sequenciando os testes.'},
        {q:'Um atraso t√≠pico no Comissionamento √© causado por:',opts:['Excesso de recursos','Falta de interface conclu√≠da (um sistema esperando o outro)','Organiza√ß√£o excessiva'],ok:1,exp:'Os sistemas s√£o interdependentes, e a falha em um trava o teste do outro.'},
        {q:'Qual o documento chave para a entrega formal ao cliente?',opts:['Di√°rio de obra','Dossi√™ de entregas (Data Book) e As-Built final','A foto da obra'],ok:1,exp:'Comprova que a obra foi constru√≠da e testada conforme contrato.'},
        {q:'A Punch List (Lista de Pend√™ncias) na entrega representa:',opts:['B√¥nus para a equipe','Pend√™ncias ou n√£o-conformidades que precisam ser resolvidas','Trabalho extra n√£o planejado'],ok:1,exp:'Deve ser zerada antes do Acceptance Certificate do cliente.'},
        {q:'Validar o sistema indica:',opts:['Obras a fazer','Entrega formal ao cliente e in√≠cio da garantia/opera√ß√£o','Fim do projeto'],ok:1,exp:'√â a transfer√™ncia de responsabilidade da construtora para o operador.'},
        {q:'Qual disciplina geralmente √© mais cr√≠tica/final no Comissionamento?',opts:['Estrutura civil','Instrumenta√ß√£o/tubula√ß√£o e el√©trica','Pintura'],ok:1,exp:'S√£o os sistemas que controlam a opera√ß√£o e a automa√ß√£o da planta.'}
      ],
      
      // ===========================
      // N√çVEL ESPECIALISTA (21-30)
      // ===========================
      
      // MOD 21: Gest√£o de Interfaces entre Disciplinas
      21: [
        {q:'Interface √© definida como:',opts:['Uma reuni√£o chata','Depend√™ncia e ponto de conex√£o entre duas disciplinas (ex: Civil e Mec√¢nica)','Apenas o limite de um contrato'],ok:1,exp:'Onde uma disciplina termina e a outra come√ßa; pontos cr√≠ticos de coordena√ß√£o.'},
        {q:'A falha comum na gest√£o de interfaces √©:',opts:['O alinhamento constante','Disciplinas n√£o se conversarem ou n√£o definirem o ponto de entrega','A falta de guindaste'],ok:1,exp:'A falta de comunica√ß√£o sobre os limites e requisitos m√∫tuos gera retrabalho.'},
        {q:'Qual a ferramenta chave para gerenciar interfaces?',opts:['Ata de reuni√£o','Reuni√µes de interface focadas e Matriz de Responsabilidades (RACI)','E-mail para todos'],ok:1,exp:'Reuni√µes peri√≥dicas para travar os requisitos e monitorar o status m√∫tuo.'},
        {q:'O indicador mais cr√≠tico da gest√£o de interface √©:',opts:['N√∫mero de documentos','Impacto no caminho cr√≠tico','Custo da interface'],ok:1,exp:'Focar nas interfaces que, se falharem, atrasam o projeto inteiro.'},
        {q:'Uma gest√£o eficiente de interfaces reduz:',opts:['A seguran√ßa','Retrabalho, conflitos e paradas inesperadas','Apressa a execu√ß√£o'],ok:1,exp:'Evita que o trabalho tenha que ser refeito porque a outra equipe n√£o estava pronta.'},
        {q:'Quem deve ser o "Dono" da Interface?',opts:['O Planejamento','A disciplina que precisa liberar o avan√ßo ou tem o risco maior','O cliente'],ok:1,exp:'A responsabilidade clara para destravar o avan√ßo √© vital (accountability).'},
        {q:'Atrasos e problemas normalmente surgem em:',opts:['Frentes grandes e simples','Interliga√ß√µes, testes e pontos de transi√ß√£o','Servi√ßos isolados'],ok:1,exp:'A complexidade aumenta na jun√ß√£o dos sistemas.'},
        {q:'A melhor solu√ß√£o para evitar falhas em interfaces √©:',opts:['Planejar separado','Planejamento conjunto, alinhado e documenta√ß√£o clara dos limites','Deixar para o campo resolver'],ok:1,exp:'Pull Planning e Lookahead multi-disciplinar s√£o ideais.'}
      ],
      // MOD 22: Planejamento Integrado com BIM (4D)
      22: [
        {q:'Planejamento 4D √© definido como:',opts:['O projeto bonito','O cronograma integrado ao modelo 3D (Tempo)','O custo da obra'],ok:1,exp:'Adiciona a dimens√£o tempo (schedule) ao modelo 3D.'},
        {q:'O benef√≠cio principal do 4D √©:',opts:['Aumento do custo','Visualiza√ß√£o da sequ√™ncia construtiva e identifica√ß√£o de conflitos','Redu√ß√£o de reuni√µes'],ok:1,exp:'Permite simular o processo e ver a evolu√ß√£o da obra antes de come√ßar.'},
        {q:'A simula√ß√£o 4D ajuda o Planejamento a:',opts:['Comprar material','Identificar interfer√™ncias de log√≠stica, acesso e sequ√™ncia','Calcular efetivo'],ok:1,exp:'Evita que o guindaste bloqueie a passagem ou que a sequ√™ncia seja il√≥gica.'},
        {q:'Os resultados visuais do 4D s√£o:',opts:['Plantas coloridas','Simula√ß√µes de avan√ßo e v√≠deos de constru√ß√£o virtual','Planilhas de custo'],ok:1,exp:'O v√≠deo da constru√ß√£o √© uma ferramenta poderosa de alinhamento.'},
        {q:'Quem deve alimentar e manter o modelo 4D atualizado?',opts:['O cliente','Planejamento e Engenharia (respons√°veis pela informa√ß√£o)','O time de montagem'],ok:1,exp:'O modelo deve refletir o que est√° sendo planejado e executado.'},
        {q:'A atualiza√ß√£o do modelo 4D deve ser:',opts:['Apenas no in√≠cio','Semanal ou quinzenalmente','Somente no final da obra'],ok:1,exp:'Precisa acompanhar o ciclo do planejamento de curto prazo para ser √∫til.'},
        {q:'A tomada de decis√£o baseada em 4D usa:',opts:['Intui√ß√£o','Cen√°rios realistas de construtibilidade e prazos','Relat√≥rios longos'],ok:1,exp:'Permite comparar planos (A vs B) e escolher o de menor risco/melhor fluxo.'},
        {q:'A integra√ß√£o 4D gera uma grande vantagem em:',opts:['Or√ßamento','Startup, comissionamento e sequenciamento de frentes','Contrata√ß√£o de pessoal'],ok:1,exp:'A sequ√™ncia l√≥gica do comissionamento √© validada visualmente no 4D.'}
      ],
      // MOD 23: Planejamento de Grandes Paradas (Shutdowns)
      23: [
        {q:'O principal desafio de uma Grande Parada √©:',opts:['Almo√ßo','Janela curta de tempo com √≥timos recursos e alta criticidade','Falta de projetos'],ok:1,exp:'Tempo √© dinheiro (milh√µes/dia). O plano precisa ser cir√∫rgico.'},
        {q:'Na Parada, quem "manda" no cronograma?',opts:['O cliente','O Caminho Cr√≠tico (folga zero)','O almoxarifado'],ok:1,exp:'Qualquer deslize no caminho cr√≠tico impacta o prazo total da Parada.'},
        {q:'O cronograma da Parada deve ser:',opts:['Apenas di√°rio','Hor√°rio e com folga zero ou negativa','Com folga de 30%'],ok:1,exp:'Planejamento de micro-escala, com horas exatas para cada tarefa do CC.'},
        {q:'A frequ√™ncia das reuni√µes de alinhamento na Parada √©:',opts:['Mensal','Di√°ria e r√°pida (antes e depois do turno)','Semanal'],ok:1,exp:'O monitoramento precisa ser em tempo real para a√ß√µes imediatas.'},
        {q:'O maior risco em uma Parada √©:',opts:['Custo alto','Atraso em atividade cr√≠tica do Caminho Cr√≠tico','Falta de caf√©'],ok:1,exp:'O atraso do CC aumenta o tempo de inatividade da planta.'},
        {q:'A Conting√™ncia (Plano B) na Parada deve envolver:',opts:['Novos contratos','Equipes reserva, equipamentos de emerg√™ncia e planos alternativos','Apenas promessas'],ok:1,exp:'Tudo precisa estar pronto para ser acionado se o plano A falhar.'},
        {q:'A interface essencial para a Parada √©:',opts:['RH','Seguran√ßa, Qualidade e Suprimentos (entrega just-in-time)','Marketing'],ok:1,exp:'Seguran√ßa para liberar e Suprimentos para garantir os itens na hora exata.'},
        {q:'O fim da Parada depende de:',opts:['Libera√ß√£o do engenheiro','Comissionamento e testes liberados','Fim do pagamento'],ok:1,exp:'O sistema precisa ser testado e entregue para opera√ß√£o.'}
      ],
      // MOD 24: Log√≠stica Avan√ßada de Campo
      24: [
        {q:'A Log√≠stica de Campo visa principalmente:',opts:['Aumentar o n√∫mero de reuni√µes','Reduzir o deslocamento e o tempo de espera (Waste Time)','Comprar mais caminh√µes'],ok:1,exp:'Otimizar o fluxo de materiais e pessoas.'},
        {q:'O movimento e a espera de material s√£o considerados:',opts:['Trabalho que agrega valor','Desperd√≠cio (Muda)','Uma necessidade'],ok:1,exp:'O material deve ir direto para o ponto de consumo.'},
        {q:'Um Layout de Canteiro eficiente influencia diretamente:',opts:['Apenas o custo','A Produtividade e o tempo de deslocamento','A cor do uniforme'],ok:1,exp:'Reduzir a dist√¢ncia entre o almoxarifado e a frente √© ganho de HH.'},
        {q:'A gest√£o de frota compartilhada (√¥nibus, muncks) exige:',opts:['Uso livre','Programa√ß√£o visual e agendamento centralizado','Muitas planilhas'],ok:1,exp:'Transpar√™ncia e agendamento evitam o conflito de recursos.'},
        {q:'Janela log√≠stica significa:',opts:['Hor√°rio de almo√ßo','Hor√°rios espec√≠ficos para entrada e acesso de ve√≠culos e materiais cr√≠ticos','Tempo de folga'],ok:1,exp:'Controlar o fluxo de acesso para n√£o congestionar o canteiro e as frentes.'},
        {q:'Melhorar a log√≠stica de campo gera:',opts:['Caos','Fluxo cont√≠nuo e redu√ß√£o de ociosidade','Mais invent√°rio'],ok:1,exp:'Se a log√≠stica falha, o fluxo da obra quebra.'},
        {q:'Estoque de material posicionado pr√≥ximo √† frente de servi√ßo:',opts:['Ganha tempo de montagem e reduz movimenta√ß√£o','Causa desorganiza√ß√£o','√â mais caro'],ok:0,exp:'Estoque no ponto de uso (Ponto de Consumo) √© Lean.'},
        {q:'O check di√°rio de rotas e acessos garante que:',opts:['A log√≠stica est√° em dia e as rotas est√£o livres de interfer√™ncias','A equipe est√° no hor√°rio','O clima est√° bom'],ok:0,exp:'Verificar a condi√ß√£o das estradas internas e a libera√ß√£o das frentes.'}
      ],
      // MOD 25: An√°lise de Desempenho com Dados (KPIs avan√ßados)
      25: [
        {q:'Um KPI (Key Performance Indicator) deve ser:',opts:['Complexo e detalhado','Relevante, atualizado e acion√°vel','Est√°tico'],ok:1,exp:'Precisa te dizer o que fazer e onde agir (foco no futuro, n√£o no passado).'},
        {q:'Um KPI "bonito" mas que n√£o gera a√ß√£o √© um:',opts:['Sucesso','Desperd√≠cio de tempo e esfor√ßo','Necessidade'],ok:1,exp:'N√£o perca tempo medindo o que n√£o √© cr√≠tico para a decis√£o.'},
        {q:'O KPI do Caminho Cr√≠tico deve ter qual prioridade de monitoramento?',opts:['Baixa','Absoluta','M√©dia'],ok:1,exp:'Se o CC desvia, o prazo final desvia. O CC √© a prioridade.'},
        {q:'A frequ√™ncia de an√°lise dos KPIs cr√≠ticos deve ser:',opts:['Mensal','Semanal ou di√°ria','Anual'],ok:1,exp:'A a√ß√£o corretiva precisa ser r√°pida, ent√£o o dado tem que ser fresco.'},
        {q:'A cor vermelha em um Dashboard significa:',opts:['Tudo bem','Risco ou desvio cr√≠tico que exige A√ß√£o Imediata','Problema do cliente'],ok:1,exp:'Semaforiza√ß√£o √© o motor da gest√£o √† vista (Gest√£o por Exce√ß√£o).'},
        {q:'Os dados que alimentam os KPIs devem ser:',opts:['Aproximados','Confi√°veis, rastre√°veis e validados no campo','Apenas do software'],ok:1,exp:'Decis√£o baseada em fatos, n√£o em palpites (GIGO - Garbage In, Garbage Out).'},
        {q:'Os respons√°veis por atualizar os dados (propriet√°rios do KPI) devem ser:',opts:['A diretoria','Planejamento e Campo (Last Planners)','O RH'],ok:1,exp:'O dado nasce na ponta, no ch√£o de f√°brica/obra.'},
        {q:'A decis√£o estrat√©gica na obra deve ser baseada em:',opts:['Opini√£o do gerente','Fatos, indicadores e dados confi√°veis','Apenas no humor do dia'],ok:1,exp:'Gest√£o data-driven (orientada a dados).'}
      ],
      // MOD 26: Gest√£o de Mudan√ßas (Change Management)
      26: [
        {q:'Uma mudan√ßa no escopo ou projeto altera sempre:',opts:['A cor da obra','Escopo, prazo e custo','Apenas o material'],ok:1,exp:'A Tr√≠ade de Ferro √© sempre impactada por mudan√ßas n√£o controladas.'},
        {q:'A ferramenta de controle de mudan√ßas mais importante √©:',opts:['Reuni√£o informal','Registro formal da mudan√ßa (Request For Change - RFC)','O di√°rio de obra'],ok:1,exp:'Documentar o que mudou, quem pediu, por qu√™ e o impacto.'},
        {q:'O impacto da mudan√ßa no prazo deve:',opts:['Ser ignorado','Ser avaliado imediatamente no cronograma (Quick Check)','Ser checado no final'],ok:1,exp:'Qualquer mudan√ßa no escopo/projeto pode mover o Caminho Cr√≠tico.'},
        {q:'Quem inicia formalmente o processo de mudan√ßa (RFC)?',opts:['O Planejamento','Engenharia, Cliente ou qualquer parte afetada','O seguran√ßa'],ok:1,exp:'A origem da mudan√ßa pode ser interna ou externa.'},
        {q:'Quem deve validar e aprovar a mudan√ßa (RFC)?',opts:['Apenas o campo','Planejamento, Gerenciamento de Projetos e Cliente (se for impacto contratual)','O fornecedor'],ok:1,exp:'Envolve o custo, o prazo e o contrato.'},
        {q:'A mudan√ßa deve ser documentada?',opts:['N√£o, √© perda de tempo','Sempre, para evitar conflitos e rastrear o custo','Apenas as grandes'],ok:1,exp:'A documenta√ß√£o √© a defesa da empresa em casos de disputa.'},
        {q:'Regras claras de gest√£o de mudan√ßas evitam:',opts:['Trabalho','Conflitos contratuais, estouro de custo e atrasos n√£o previstos','O atraso'],ok:1,exp:'Estabelece o processo formal de ajuste do contrato/escopo.'},
        {q:'As mudan√ßas afetam diretamente o:',opts:['Almo√ßo','Caminho Cr√≠tico','O humor da equipe'],ok:1,exp:'O Planejamento precisa recalcular o CC ap√≥s a aprova√ß√£o da mudan√ßa.'}
      ],
      // MOD 27: Curva de Aprendizado (Learning Curve)
      27: [
        {q:'Equipe experiente (Curva de Aprendizado) tipicamente:',opts:['Produz a mesma coisa','Produz mais r√°pido e com mais qualidade','Causa mais problemas'],ok:1,exp:'O tempo para fazer a mesma tarefa diminui a cada repeti√ß√£o.'},
        {q:'A Curva de Aprendizado significa:',opts:['Mais HH gasto','Redu√ß√£o progressiva do tempo/HH necess√°rio para uma unidade','Constru√ß√£o mais lenta'],ok:1,exp:'Menos esfor√ßo para o mesmo resultado ao longo do tempo.'},
        {q:'O indicador (HH/unidade) melhora com:',opts:['Falta de planejamento','A cada ciclo de repeti√ß√£o','Mudan√ßas constantes'],ok:1,exp:'A performance aumenta conforme o time pega o jeito.'},
        {q:'O dado que precisamos medir para plotar a Curva √©:',opts:['Peso do material','HH/unidade inicial e a produ√ß√£o em cada ciclo','Apenas o custo'],ok:1,exp:'Mede a taxa de melhoria da produtividade.'},
        {q:'A melhor forma de acelerar o aprendizado √© com:',opts:['Nenhuma interven√ß√£o','Treinamento, repeti√ß√£o e feedback constante do planejamento','Contratar mais gente'],ok:1,exp:'Planejamento pode criar "Work Packages" repetitivos para otimizar.'},
        {q:'A sobrecarga ou pressa excessiva da equipe na curva:',opts:['Acelera o aprendizado','Destr√≥i a curva e aumenta os erros/retrabalho','√â fundamental'],ok:1,exp:'Estabilidade e qualidade s√£o cruciais para o aprendizado.'},
        {q:'Um ciclo de trabalho curto (tarefas menores) ajuda a:',opts:['Confundir','Acelerar a evolu√ß√£o da curva e o feedback','Diminuir a produtividade'],ok:1,exp:'O feedback sobre a performance √© mais r√°pido.'},
        {q:'A Curva de Aprendizado √© mais vis√≠vel em:',opts:['Atividades √∫nicas','Atividades repetitivas (ex: lan√ßamento de tubula√ß√£o, solda de esquadrias)','Reuni√µes'],ok:1,exp:'A repeti√ß√£o √© o motor do aprendizado.'}
      ],
      // MOD 28: Resolu√ß√£o de Problemas (Lean PDCA / 5 Porqu√™s)
      28: [
        {q:'O ciclo PDCA significa:',opts:['Primeiro-Depois-Chega-Atrasa','Plan-Do-Check-Act (Planejar-Fazer-Checar-Agir)','Pode-Dar-Certo-Amanh√£'],ok:1,exp:'Metodologia de melhoria cont√≠nua (deming wheel).'},
        {q:'A t√©cnica dos "5 Porqu√™s" revela:',opts:['A desculpa do atraso','A Causa Raiz do problema','O respons√°vel pelo erro'],ok:1,exp:'Permite ir al√©m do sintoma e achar a fonte do problema.'},
        {q:'A solu√ß√£o de um problema deve ser:',opts:['Imediata','Eficaz, padronizada e verific√°vel (que funcione e evite recorr√™ncia)','Tempor√°ria'],ok:1,exp:'Agir sobre a causa raiz para que o problema n√£o volte.'},
        {q:'O "Dono da A√ß√£o" (Respons√°vel pela Solu√ß√£o) deve ser:',opts:['O Planejamento','Quem tem o poder/responsabilidade de execut√°-la','O cliente'],ok:1,exp:'Accountability para garantir que a a√ß√£o de melhoria seja feita.'},
        {q:'A Revis√£o do impacto (Check) deve ser feita:',opts:['Nunca','Ap√≥s a implementa√ß√£o da solu√ß√£o','Na hora do problema'],ok:1,exp:'Avaliar se a solu√ß√£o (Act) realmente resolveu o problema (An√°lise de Resultados).'},
        {q:'Reagir a problemas sem an√°lise pr√©via geralmente:',opts:['Resolve tudo','Gera retrabalho e mais problemas (apenas no sintoma)','√â a melhor pr√°tica'],ok:1,exp:'Tentar remediar sem saber a causa raiz √© perda de tempo.'},
        {q:'A causa comum de falha na resolu√ß√£o de problemas √©:',opts:['Falta de dinheiro','Treinar s√≥ no sintoma, sem atacar a causa raiz','Ter muitos dados'],ok:1,exp:'O tratamento precisa ser na raiz, n√£o na folha.'},
        {q:'A melhoria cont√≠nua (Kaizen) exige da equipe:',opts:['Apenas treinamento','Cultura de aprendizado, transpar√™ncia e disciplina','Puni√ß√£o por erro'],ok:1,exp:'Incentivar a identifica√ß√£o e a corre√ß√£o de problemas.'}
      ],
      // MOD 29: Planejamento Orientado ao Cliente (VOE ‚Äî Valor)
      29: [
        {q:'No Lean, o Cliente define:',opts:['O cronograma','O que realmente tem valor','Quem ser√° o gerente'],ok:1,exp:'Valor √© definido pela perspectiva de quem usa o produto final.'},
        {q:'Valor √© o que:',opts:['D√° mais lucro','Avan√ßa o resultado final e o cliente est√° disposto a pagar','√â f√°cil de fazer'],ok:1,exp:'Tudo que n√£o agrega valor √© desperd√≠cio.'},
        {q:'Uma atividade sem valor (desnecess√°ria) √© considerada:',opts:['Processo','Desperd√≠cio (Waste/Muda)','Trabalho'],ok:1,exp:'Ex: Refazer um desenho ou esperar material.'},
        {q:'A prioridade do planejamento deve vir de:',opts:['O que o mestre quer','Caminho cr√≠tico + o que entrega valor ao cliente','Apenas o custo'],ok:1,exp:'Focar no que avan√ßa a entrega final do ativo.'},
        {q:'O feedback do cliente (VOE - Voice of the Customer) deve ser:',opts:['Uma vez por ano','Constante e integrado ao planejamento','Apenas em caso de briga'],ok:1,exp:'Garantir que o que est√° sendo constru√≠do ainda atende √† necessidade atual dele.'},
        {q:'O cliente participa da programa√ß√£o da obra em qual processo?',opts:['Reuni√£o de RH','No Pull Planning (defini√ß√£o das macro-etapas)','No di√°rio de obra'],ok:1,exp:'Ele ajuda a definir a sequ√™ncia l√≥gica e a prioridade das entregas.'},
        {q:'O valor (prioridade do cliente) muda com:',opts:['O tempo','Contexto e mudan√ßa de mercado','A fase da lua'],ok:1,exp:'O planejamento precisa ser flex√≠vel para se adaptar √† mudan√ßa de valor.'},
        {q:'O resultado de um planejamento orientado a valor √©:',opts:['Economia de 10%','Entrega com excel√™ncia, no prazo e no escopo que o cliente realmente precisa','Mais trabalho'],ok:1,exp:'Focar no que o cliente realmente valoriza.'}
      ],
      // MOD 30: Controle em Tempo Real (Live-Data Planning)
      30: [
        {q:'Dado em tempo real no planejamento permite:',opts:['Atraso','Agilidade na tomada de decis√£o e corre√ß√£o de rota','Mais d√∫vidas'],ok:1,exp:'Saber o que est√° acontecendo AGORA (ou D-1) e n√£o no final do m√™s.'},
        {q:'Informar o status da execu√ß√£o (check-in/out) deve ser feito:',opts:['Com 1 semana de atraso','Imediatamente, via app ou Folha Tarefa digital','Apenas por e-mail'],ok:1,exp:'O delay do dado √© o delay da a√ß√£o corretiva.'},
        {q:'A tecnologia (apps, tablets) facilita:',opts:['Atrasar','O fluxo da informa√ß√£o do campo para a decis√£o','O desperd√≠cio'],ok:1,exp:'A digitaliza√ß√£o da Folha Tarefa/Checklist agiliza o processo.'},
        {q:'Os indicadores chave (KPIs) para controle em tempo real s√£o:',opts:['Apenas o custo','Produtividade e PPC (Percent Plan Complete)','N√∫mero de soldas'],ok:1,exp:'Medir a efici√™ncia e a confiabilidade de forma imediata.'},
        {q:'A falha mais comum no Live-Data Planning √©:',opts:['O dado atrasado ou incorreto','A pressa','O custo do app'],ok:0,exp:'Se o dado n√£o reflete a realidade do momento, ele n√£o serve para o controle.'},
        {q:'A atualiza√ß√£o do status deve ser feita com qual frequ√™ncia?',opts:['Anual','Na hora da execu√ß√£o (ou D-1)','Mensal'],ok:1,exp:'Garantir que a informa√ß√£o na tela √© a realidade do campo.'},
        {q:'O ganho direto do controle em tempo real √©:',opts:['Aumento do lucro','Redu√ß√£o de espera, ociosidade e desperd√≠cio (Waste Time)','Mais reuni√µes'],ok:1,exp:'O planejador consegue agir antes que a frente pare.'},
        {q:'O controle em tempo real exige uma forte integra√ß√£o entre:',opts:['Contabilidade e RH','Campo (Execu√ß√£o) e Planejamento','O cliente e o fornecedor'],ok:1,exp:'O campo alimenta, o planejamento decide e o campo executa a corre√ß√£o.'}
      ],
      
      // ===========================
      // N√çVEL GERENTE / DIRETOR (31-36)
      // ===========================
      
      // MOD 31: Lideran√ßa no Planejamento
      31: [
        {q:'O gerente deve liderar a equipe de Planejamento com:',opts:['Autoritarismo','Transpar√™ncia e dados (Gest√£o √† Vista)','Intui√ß√£o'],ok:1,exp:'O time precisa saber onde est√° o problema e o que √© esperado.'},
        {q:'A Lideran√ßa Lean incentiva:',opts:['Fazer tudo sozinho','Participa√ß√£o do time na solu√ß√£o de problemas','Culpar os outros'],ok:1,exp:'O time que planeja junto se compromete junto.'},
        {q:'A comunica√ß√£o do gerente deve ser:',opts:['Vaga','Direta, objetiva e com foco nas prioridades','Cheia de jarg√µes'],ok:1,exp:'Eliminar o ru√≠do para que todos entendam a mensagem cr√≠tica.'},
        {q:'A tomada de decis√£o gerencial deve ser baseada em:',opts:['Senso comum','Fatos, indicadores (KPIs) e dados reais','A opini√£o do mais velho'],ok:1,exp:'Gest√£o baseada em dados, n√£o em achismos.'},
        {q:'O reconhecimento pelo bom desempenho (celebrar o PPC alto) melhora:',opts:['A press√£o','O engajamento e a cultura de alta performance','O custo'],ok:1,exp:'Motiva√ß√£o e refor√ßo positivo s√£o cruciais.'},
        {q:'A rotina di√°ria do gerente (Lean) deve incluir:',opts:['Ficar no escrit√≥rio','Checar o Gemba (Campo) e os KPIs cr√≠ticos','Ligar para o cliente'],ok:1,exp:'Ver o problema no local onde ele acontece.'},
        {q:'O gestor deve focar em remover o que para a equipe?',opts:['O tempo','Barreiras, restri√ß√µes e impedimentos ao fluxo de trabalho','O caf√©'],ok:1,exp:'Servir a equipe (Servant Leadership) para que ela possa produzir.'},
        {q:'A cultura de aprendizado cont√≠nuo exige do gerente:',opts:['Puni√ß√£o','Feedback cont√≠nuo, seguro para errar e PDCA','Indiferen√ßa'],ok:1,exp:'Transformar erro em aprendizado (sem medo de expor o problema).'}
      ],
      // MOD 32: Gest√£o de Custos & Or√ßamento
      32: [
        {q:'O custo real de uma tarefa depende diretamente de:',opts:['Impostos','Produtividade e horas trabalhadas (HH)','Apenas do material'],ok:1,exp:'Custo = HH x Valor da HH. A produtividade baixa estoura a HH.'},
        {q:'O estouro de custo geralmente nasce:',opts:['Na negocia√ß√£o','No campo (baixa produtividade, retrabalho)','No escrit√≥rio'],ok:1,exp:'O HH real gasto √© o principal vil√£o do custo.'},
        {q:'O controle ideal de custo deve ser feito:',opts:['No final do contrato','Semana a semana com dados reais de produ√ß√£o/HH','Mensalmente'],ok:1,exp:'O atraso de informa√ß√£o impede a a√ß√£o corretiva.'},
        {q:'O √≠ndice direto de custo mais importante para o planejamento √©:',opts:['Valor total do contrato','HH por unidade (Raz√£o Unit√°ria)','Pre√ßo da gasolina'],ok:1,exp:'Mede a efici√™ncia do trabalho humano (o que impacta o custo).'},
        {q:'Um desvio negativo no custo (estouro) requer:',opts:['Espera','A√ß√£o imediata e plano de recupera√ß√£o','Nada'],ok:1,exp:'√â preciso agir r√°pido para proteger a margem do contrato.'},
        {q:'A melhor forma de identificar desvios de custo √© com:',opts:['Opini√£o','Curva de custo (S-Curve) e KPIs de produtividade','Email'],ok:1,exp:'Comparar o custo previsto com o realizado (EVM - Earned Value Management).'},
        {q:'A primeira linha de defesa contra o estouro de custo √©:',opts:['Contratar consultoria','Planejamento bem feito (evitar retrabalho e ociosidade)','Cortar o caf√©'],ok:1,exp:'Planejamento elimina os desperd√≠cios que mais geram custo (HH improdutivo).'},
        {q:'Melhorar o custo da obra exige:',opts:['Reduzir o sal√°rio','Aumentar a entrega (produ√ß√£o) sem aumentar a HH gasta','Diminuir a qualidade'],ok:1,exp:'Ser mais eficiente com os recursos atuais.'}
      ],
      // MOD 33: Gest√£o de Riscos
      33: [
        {q:'Risco √© definido como:',opts:['Uma certeza','Evento incerto com potencial impacto positivo ou negativo','Um erro'],ok:1,exp:'Tem probabilidade de ocorrer (incerteza) e, se ocorrer, gera impacto.'},
        {q:'Os riscos devem ser classificados por:',opts:['Ordem alfab√©tica','Probabilidade x Impacto (Matriz de Risco)','Quem gritou mais alto'],ok:1,exp:'Focar os esfor√ßos de mitiga√ß√£o nos riscos de alto impacto/alta probabilidade.'},
        {q:'A melhor forma de controle de risco √©:',opts:['Aceitar','A√ß√£o preventiva (Mitiga√ß√£o)','Ignorar'],ok:1,exp:'Agir antes que o risco vire problema (ex: checar restri√ß√µes do CC antes do Lookahead).'},
        {q:'O "Dono do Risco" √©:',opts:['O Planejamento','O respons√°vel pela mitiga√ß√£o e monitoramento (quem pode agir)','O cliente'],ok:1,exp:'Cada risco deve ter um respons√°vel claro.'},
        {q:'Os riscos devem ser monitorados em:',opts:['Oculto','Reuni√µes constantes (semanais/mensais)','No final do m√™s'],ok:1,exp:'A matriz de risco √© um documento vivo que precisa de revis√£o constante.'},
        {q:'Se um risco se materializa e vira problema, voc√™ aciona:',opts:['O jur√≠dico','O Plano de Conting√™ncia','O p√¢nico'],ok:1,exp:'O plano de conting√™ncia √© o Plano B previamente desenhado.'},
        {q:'O risco de cronograma afeta diretamente o:',opts:['Custo de material','Caminho Cr√≠tico e a folga do projeto','A cor da parede'],ok:1,exp:'O foco na matriz deve ser nos riscos que afetam o prazo.'},
        {q:'A revis√£o do risco deve ser:',opts:['Est√°tica','Cont√≠nua (em diferentes fases do projeto)','Apenas para o cliente'],ok:1,exp:'O risco da mobiliza√ß√£o √© diferente do risco do comissionamento.'}
      ],
      // MOD 34: Comunica√ß√£o Executiva
      34: [
        {q:'Para a Diretoria (Comunica√ß√£o Executiva), a informa√ß√£o deve:',opts:['Ser o mais longa poss√≠vel','Ser simples, direta e focada no resultado','Ter muitos detalhes t√©cnicos'],ok:1,exp:'O Executivo precisa tomar uma decis√£o r√°pida: "Onde estamos e o que precisamos fazer?".'},
        {q:'O KPI visual para a diretoria deve:',opts:['Ter muitas cores','Mostrar o que realmente importa (CC, Desvio de Custo, Margem)','Ser escondido'],ok:1,exp:'Focar nos 3 a 5 indicadores cr√≠ticos.'},
        {q:'O vermelho (semaforiza√ß√£o) em um dashboard executivo significa:',opts:['Atraso','Decidir r√°pido ou aprovar recursos para recupera√ß√£o','Est√° tudo ok'],ok:1,exp:'Chamar a aten√ß√£o para o desvio cr√≠tico.'},
        {q:'Dashboards para a Execu√ß√£o devem:',opts:['Gerar d√∫vidas','Gerar conversa clara e acion√°vel (o que fazer agora)','Ser apenas relat√≥rios'],ok:1,exp:'Facilitar a comunica√ß√£o sem precisar de um manual.'},
        {q:'Comunica√ß√£o ruim e complexa gera:',opts:['Mais alinhamento','Decis√£o errada, atraso na a√ß√£o e conflito','Mais efici√™ncia'],ok:1,exp:'A mensagem precisa ser absorvida na primeira leitura.'},
        {q:'O melhor formato de reuni√£o executiva √©:',opts:['3 horas de PowerPoint','Curta, em p√© e com foco em 3 pontos de decis√£o','Apenas e-mail'],ok:1,exp:'Foco na decis√£o e no alinhamento estrat√©gico.'},
        {q:'O que deve ser evitado na comunica√ß√£o executiva?',opts:['Fatos','Jarg√µes, detalhes in√∫teis e explica√ß√µes complexas','Simplicidade'],ok:1,exp:'Focar no resumo e na solu√ß√£o (Elevator Pitch).'},
        {q:'O prop√≥sito final da comunica√ß√£o executiva √©:',opts:['Impress√£o','Alinhamento estrat√©gico e apoio √†s a√ß√µes do projeto','Relat√≥rio'],ok:1,exp:'Obter o suporte e recursos que o projeto precisa.'}
      ],
      // MOD 35: AWP com Cronograma Integrado
      35: [
        {q:'AWP (Advanced Work Packaging) conecta quais √°reas?',opts:['RH e Marketing','Engenharia, Planejamento e Constru√ß√£o (Campo)','O cliente e o fornecedor'],ok:1,exp:'Cria um fluxo de trabalho do projeto at√© a entrega (Integrated Work Packages).'},
        {q:'Um Work Package (Pacote de Trabalho) deve ser:',opts:['O maior poss√≠vel','Construt√≠vel, gerenci√°vel e alinhado √† sequ√™ncia de montagem','Apenas um desenho'],ok:1,exp:'Unidade de trabalho l√≥gica, liberada para ser constru√≠da no campo.'},
        {q:'AWP bem implementado reduz:',opts:['Produtividade','Interfer√™ncias, restri√ß√µes e ociosidade no campo','Custo de material'],ok:1,exp:'Garante que o campo s√≥ comece o que est√° 100% pronto (prontid√£o).'},
        {q:'O sequenciamento do trabalho (IWP/CWP) deve seguir:',opts:['Ordem do gerente','A prioridade do campo (liberar o caminho cr√≠tico)','A ordem do projeto'],ok:1,exp:'O plano do AWP √© baseado na construtibilidade.'},
        {q:'A m√©trica de sucesso do AWP √©:',opts:['PPC','Entregas por pacote conclu√≠do no prazo e no escopo','Efetivo alto'],ok:1,exp:'O foco √© na entrega do pacote de trabalho pronto e liberado.'},
        {q:'O alinhamento semanal entre as disciplinas no AWP √©:',opts:['Opcional','Fundamental para garantir que as restri√ß√µes sejam resolvidas','Burocr√°tico'],ok:1,exp:'O processo de AWP √© um ciclo cont√≠nuo de planejamento e feedback.'},
        {q:'O "Dono do WP" (Work Package) √© tipicamente:',opts:['O Planejamento','O l√≠der de execu√ß√£o/Encarregado daquela frente','A Engenharia'],ok:1,exp:'Quem √© respons√°vel por entregar o pacote no campo.'},
        {q:'O benef√≠cio principal do AWP para o Planejamento √©:',opts:['Mais documentos','Fluxo de trabalho previs√≠vel e confi√°vel (alta confiabilidade)','Mais HH'],ok:1,exp:'Elimina o caos da libera√ß√£o e execu√ß√£o.'}
      ],
      // MOD 36: Tomada de Decis√£o Estrat√©gica
      36: [
        {q:'Decis√£o estrat√©gica na obra considera:',opts:['O menor pre√ßo imediato','Custo total do ciclo de vida x impacto no prazo e qualidade','Apenas a press√£o'],ok:1,exp:'Olhar o custo e o impacto futuro, n√£o s√≥ o gasto de hoje.'},
        {q:'Os dados do campo (KPIs, produtividade, PPC) devem ser:',opts:['Ignorados','A base de qualquer decis√£o','Apenas para relat√≥rio'],ok:1,exp:'A decis√£o deve ser informada pela realidade da execu√ß√£o.'},
        {q:'O teste de uma decis√£o estrat√©gica √© o seu impacto em:',opts:['O almoxarifado','No cliente, no prazo e no custo final','No RH'],ok:1,exp:'Avaliar a decis√£o pelo valor que ela entrega.'},
        {q:'O gerente deve evitar na tomada de decis√£o:',opts:['An√°lise','Decis√µes por impulso, sem dados ou an√°lise de risco','Reuni√µes'],ok:1,exp:'Decis√£o emocional gera retrabalho caro.'},
        {q:'As reuni√µes de tomada de decis√£o estrat√©gica devem ser:',opts:['Di√°rias','Semanais e assertivas (foco no que desvia o CC)','Apenas no problema'],ok:1,exp:'Monitorar o desvio e decidir a corre√ß√£o de rota com frequ√™ncia.'},
        {q:'Se o contexto muda (ex: mercado, cliente), a decis√£o anterior:',opts:['√â fixa','Pode e deve mudar (flexibilidade)','Est√° errada'],ok:1,exp:'O planejamento √© adaptativo e a decis√£o acompanha a realidade.'},
        {q:'O respons√°vel final por uma decis√£o de alto risco √©:',opts:['O Planejamento','O Gerente ou Diretor do Projeto','O cliente'],ok:1,exp:'O l√≠der assume a responsabilidade pelo resultado.'},
        {q:'O resultado esperado da decis√£o estrat√©gica √©:',opts:['Fazer tudo r√°pido','Entrega de valor, no prazo e com seguran√ßa','Menos trabalho'],ok:1,exp:'O foco √© no sucesso do projeto, n√£o na atividade isolada.'}
      ],
      
      // ===========================
      // N√çVEL VISION√ÅRIO (37-40)
      // ===========================

      // MOD 37: Intelig√™ncia Artificial na Obra
      37: [
        {q:'A IA (Intelig√™ncia Artificial) ajuda o Planejamento a:',opts:['Aumentar o HH','Prever riscos, produtividade e otimizar sequ√™ncias','Substituir o gerente'],ok:1,exp:'Analisar grandes volumes de dados para identificar padr√µes e tend√™ncias.'},
        {q:'Uso principal da IA √© para gerar:',opts:['Relat√≥rios longos','Decis√µes mais r√°pidas e informadas por dados','Mais burocracia'],ok:1,exp:'Transforma a capacidade de an√°lise em a√ß√£o.'},
        {q:'A principal limita√ß√£o no uso de IA √©:',opts:['O custo','A qualidade e a integridade dos dados coletados','O clima'],ok:1,exp:'Se o dado de entrada √© ruim, a previs√£o ser√° ruim (Garbage In, Garbage Out).'},
        {q:'Uma aplica√ß√£o pr√°tica da IA √© a:',opts:['Previs√£o do pre√ßo do d√≥lar','Previs√£o de PPC, √≠ndices de produtividade e an√°lise de desvios','Previs√£o do tempo'],ok:1,exp:'Prever a performance para agir antes que o desvio ocorra.'},
        {q:'Quem √© o respons√°vel por gerenciar a IA no Planejamento?',opts:['O cliente','O Planejamento Digital ou Engenheiro de Dados','O campo'],ok:1,exp:'Especialista que entende o processo e a tecnologia.'},
        {q:'O benef√≠cio da IA no Planejamento √© a:',opts:['Lentid√£o','Agilidade na corre√ß√£o de rota e antecipa√ß√£o de problemas','Aumento de custos'],ok:1,exp:'A m√°quina analisa mais r√°pido do que o humano.'},
        {q:'O Pipeline de dados (fluxo de informa√ß√£o) deve ser:',opts:['Planilha Excel','Campo ‚Üí Nuvem ‚Üí Dashboards / IA','Apenas e-mail'],ok:1,exp:'Garantir a coleta de dados da ponta para o sistema de an√°lise.'},
        {q:'O futuro do Planejamento pode incluir:',opts:['Mais papel','Obra autoconduzida por IA (guiada por dados)','Menos engenheiros'],ok:1,exp:'Otimiza√ß√£o e automa√ß√£o m√°xima do fluxo de trabalho.'}
      ],
      // MOD 38: Planejamento 5D (Custo + Prazo + Modelo)
      38: [
        {q:'O Planejamento 5D integra:',opts:['Apenas o custo','Custo ao modelo 4D (Tempo + Modelo + Custo)','O material'],ok:1,exp:'Adiciona a 5¬™ dimens√£o: o Custo (Budget) no tempo.'},
        {q:'O benef√≠cio do 5D √©:',opts:['Atraso','Visualizar o custo real ao longo do tempo (Curva S Financeira)','Menos controle'],ok:1,exp:'Permite ver quanto deve ter sido gasto at√© uma determinada data (Controle Financeiro).'},
        {q:'O 5D ajuda o Gerente a:',opts:['Aumentar o risco','Controlar o or√ßamento, prever o fluxo de caixa e o valor ganho (EVM)','Comprar material'],ok:1,exp:'Ferramenta poderosa de gest√£o financeira e de cronograma.'},
        {q:'O dado base para o 5D √©:',opts:['Opini√£o','Quantidades do 3D + RUP (√çndice) + Custo Unit√°rio','Apenas o sal√°rio'],ok:1,exp:'Custo = Quantidade x (HH/Unid) x Valor/HH.'},
        {q:'O risco no 5D ocorre quando:',opts:['O custo √© baixo','O modelo 3D ou o cronograma n√£o est√£o revisados/corretos','A equipe √© grande'],ok:1,exp:'O 5D herda os erros do 3D e 4D (Garbage In).'},
        {q:'A atualiza√ß√£o do modelo 5D deve ser:',opts:['Anual','Peri√≥dica e rastre√°vel (garantir que o custo segue o avan√ßo real)','Apenas para o cliente'],ok:1,exp:'Precisa acompanhar o ciclo do planejamento e medi√ß√£o.'},
        {q:'O "Dono" do 5D √©:',opts:['O cliente','O Planejamento em conjunto com a √°rea de Custos','O financeiro'],ok:1,exp:'Integra√ß√£o total entre escopo, prazo e custo.'},
        {q:'O resultado do 5D √©:',opts:['Planilha longa','Previs√£o financeira precisa e gest√£o de desempenho integrada','Mais HH'],ok:1,exp:'A Curva S Financeira gerada √© a base do controle.'}
      ],
      // MOD 39: Power BI e Dashboards Integrados
      39: [
        {q:'BI (Business Intelligence) significa:',opts:['Informa√ß√£o de Neg√≥cio','Intelig√™ncia do Neg√≥cio (Transformar Dados em Conhecimento)','Software caro'],ok:1,exp:'Conjunto de ferramentas e processos para extrair valor dos dados.'},
        {q:'Dashboards com BI servem para:',opts:['Decora√ß√£o','Decis√£o r√°pida e gest√£o √† vista','Atrasar'],ok:1,exp:'Simplificam dados complexos em visuais f√°ceis de entender.'},
        {q:'√â preciso ter aten√ß√£o com o que em um dashboard?',opts:['O nome do gerente','A fonte dos dados (deve ser confi√°vel e √∫nica)','A cor'],ok:1,exp:'Se a fonte √© manual ou n√£o confi√°vel, o dashboard √© in√∫til.'},
        {q:'O visual do dashboard deve ser:',opts:['Complexo','Intuitivo, limpo e acion√°vel','Monocrom√°tico'],ok:1,exp:'O gestor precisa entender o status em 5 segundos.'},
        {q:'A atualiza√ß√£o do dashboard deve ser:',opts:['Manual e mensal','Autom√°tica e em tempo real (se poss√≠vel)','Apenas para o cliente'],ok:1,exp:'Dados frescos para decis√µes frescas.'},
        {q:'O "Dono da Informa√ß√£o" que alimenta o BI √©:',opts:['O desenvolvedor','Quem coleta os dados na ponta (Campo/Planejamento)','O CEO'],ok:1,exp:'O campo precisa alimentar o sistema corretamente.'},
        {q:'O indicador no BI deve mostrar:',opts:['Apenas o sucesso','Padr√µes, riscos e desvios cr√≠ticos','Apenas o custo'],ok:1,exp:'Alertar o gerente sobre onde agir (Exce√ß√£o).'},
        {q:'O benef√≠cio do BI √© a:',opts:['Burocracia','Gest√£o de obra em tempo real e colabora√ß√£o','Isolamento de dados'],ok:1,exp:'Todos na mesma p√°gina, com a mesma vis√£o de status.'}
      ],
      // MOD 40: Planejamento Baseado em Simula√ß√µes
      40: [
        {q:'A Simula√ß√£o (ex: Monte Carlo) ajuda o Planejamento a:',opts:['Chutar o prazo','Antecipar cen√°rios de risco e incerteza','Aumentar o custo'],ok:1,exp:'Testa milhares de cen√°rios com diferentes probabilidades de HH e risco.'},
        {q:'A base para rodar uma simula√ß√£o confi√°vel √©:',opts:['Opini√£o','Dados hist√≥ricos e √≠ndices de produtividade reais','Apenas o software'],ok:1,exp:'O dado passado alimenta a previs√£o futura.'},
        {q:'A simula√ß√£o de Cen√°rio Pessimista ajuda a:',opts:['Atrasar','Minimizar riscos e definir folgas de seguran√ßa (Buffer)','Otimizar'],ok:1,exp:'Prepara o time para o pior caso, tornando o plano mais robusto.'},
        {q:'O respons√°vel por rodar e interpretar a simula√ß√£o √©:',opts:['O financeiro','O Planejamento Avan√ßado/Controle','O cliente'],ok:1,exp:'Exige conhecimento estat√≠stico e de cronograma.'},
        {q:'A maior vantagem da simula√ß√£o √© a:',opts:['Atraso','Mitiga√ß√£o antecipada e aloca√ß√£o inteligente de recursos','Certeza'],ok:1,exp:'Saber onde colocar o esfor√ßo de forma estrat√©gica.'},
        {q:'Uma ferramenta comum de simula√ß√£o no planejamento √©:',opts:['PowerPoint','Simula√ß√£o Monte Carlo','Excel b√°sico'],ok:1,exp:'Usa estat√≠stica para prever a probabilidade de cumprimento de prazo.'},
        {q:'O melhor uso da simula√ß√£o √© para:',opts:['Tarefas di√°rias','Grandes decis√µes e projetos de alto risco/incerteza','Atividades simples'],ok:1,exp:'Decis√µes estrat√©gicas (ex: Prazo de Entrega do Contrato).'},
        {q:'O resultado da simula√ß√£o √© um cronograma mais:',opts:['F√°cil','Robusto, com buffers alocados e alto % de probabilidade de cumprimento','Caro'],ok:1,exp:'Aumenta a confian√ßa na data de entrega (Project Confidence).'}
      ]
    };

    // =========================================================================
    // L√ìGICA DE N√çVEIS E DESBLOQUEIO
    // =========================================================================
    
    function getLevel(xp) {
      for (let i = LEVELS.length - 1; i >= 0; i--) {
        if (xp >= LEVELS[i].minXp) {
          return LEVELS[i];
        }
      }
      return LEVELS[0];
    }
    
    function isModuleLocked(modId, modLevel) {
      if (modLevel === 'T√©cnico') return false;
      if (S.completed.includes(modId)) return false; 
      
      const unlockedByPass = S.tempPass === '2025*'; // Se a senha foi usada e √© a padr√£o
      
      if (modLevel === 'Analista') {
        // Analista exige todos os m√≥dulos de T√©cnico (IDs 1-12)
        const allTecCompleted = TEC_IDS.every(id => S.completed.includes(id));
        return !allTecCompleted && !unlockedByPass; // Bloqueia se TEC n√£o estiver completo E a senha n√£o foi usada
      }
      
      // Para outros n√≠veis (Especialista, Gerente, Vision√°rio), vamos simplificar:
      // Se n√£o for Analista, exige o n√≠vel anterior completo.
      // Ou seja, se o m√≥dulo estiver no n√≠vel "Analista", e n√£o for o primeiro do n√≠vel, ele estaria bloqueado se n√£o tiver TEC completo.
      // O modo mais simples: se n√£o √© T√©cnico, e n√£o est√° completo, est√° bloqueado, a menos que a senha 2025* esteja ativa.
      // Para manter o desbloqueio por senha, retornamos:
      return !unlockedByPass;
    }
    
    // =========================================================================
    // FUN√á√ïES DE PERSIST√äNCIA E SINCRONIZA√á√ÉO
    // =========================================================================

    function saveState() {
      S.updatedAt = Date.now();
      localStorage.setItem('duoplanningState', JSON.stringify(S));
      if (S.uid) {
        setDoc(doc(db, "users", S.uid), S, { merge: true }).catch(console.error);
      }
      updateUI();
    }
    
    function updateUI() {
      const currentLevel = getLevel(S.xp);
      const completedCount = S.completed.length;
      const progress = Math.round((completedCount / TOTAL_MODULES) * 100);
      
      UI.userName.textContent = `Ol√°, ${S.name || 'Mestre'}!`;
      UI.configUserName.textContent = S.uid ? `${S.name} (Google)` : `${S.name} (Local)`;
      UI.userLevel.textContent = `N√≠vel: ${currentLevel.id}`;
      UI.xpCurrent.textContent = S.xp;
      UI.xpFill.style.width = `${Math.min(100, (S.xp / (currentLevel.minXp + XP_PER_MODULE)) * 100)}%`;
      UI.statCompleted.textContent = completedCount;
      UI.statProgress.textContent = `${progress}%`;
      UI.statLevelBadge.textContent = currentLevel.id.substring(0, 1);
      UI.statLevelBadge.style.color = currentLevel.color;
      UI.statLevelBadge.closest('.stat-box').style.borderColor = currentLevel.color;
      
      renderModules();
    }

    function renderModules() {
      UI.modulesList.innerHTML = '';
      let currentLevelHeader = '';
      
      DB_MODULES.forEach(mod => {
        if (mod.level !== currentLevelHeader) {
          currentLevelHeader = mod.level;
          const levelClass = `level-${mod.level.toLowerCase().replace('/', '').replace(' ', '')}`;
          UI.modulesList.innerHTML += `<div class="level-header ${levelClass}">${mod.level}</div>`;
        }
        
        const isCompleted = S.completed.includes(mod.id);
        const isLocked = isModuleLocked(mod.id, mod.level);
        
        let statusClass = isCompleted ? 'completed' : (isLocked ? 'locked' : '');
        let lockIcon = isCompleted ? '‚úîÔ∏è' : (isLocked ? 'üîí' : '‚ñ∂Ô∏è');
        let cardColor = isCompleted ? 'white' : 'var(--text)';
        let cardBackground = isCompleted ? 'var(--success)' : (isLocked ? 'var(--panel)' : 'var(--panel)');
        
        const modCard = document.createElement('div');
        modCard.className = `module-card ${statusClass}`;
        modCard.style.color = cardColor;
        modCard.style.backgroundColor = cardBackground;
        modCard.setAttribute('data-id', mod.id);
        modCard.setAttribute('data-level', mod.level);
        modCard.innerHTML = `
          <div class="module-card-title">${mod.id} - ${mod.title}</div>
          <div style="font-size:0.8em; color:${isCompleted ? 'white' : 'var(--muted)'}">${mod.level}</div>
          <span class="lock-icon" data-id="${mod.id}">${lockIcon}</span>
        `;
        
        if (!isLocked) {
          modCard.onclick = () => startQuiz(mod.id);
        } else {
          modCard.onclick = () => promptUnlock(mod.id, mod.level);
        }
        
        UI.modulesList.appendChild(modCard);
      });
    }

    // =========================================================================
    // L√ìGICA DE QUIZ
    // =========================================================================
    
    let currentQuiz = {
      modId: null,
      questions: [],
      qIndex: 0,
      correctCount: 0
    };

    function startQuiz(modId) {
      const mod = DB_MODULES.find(m => m.id === modId);
      currentQuiz.modId = modId;
      currentQuiz.questions = DB_QUIZ[modId];
      currentQuiz.qIndex = 0;
      currentQuiz.correctCount = 0;

      UI.quizModIcon.textContent = mod.icon;
      UI.quizModId.textContent = mod.id;
      UI.quizModTitle.textContent = mod.title;
      
      // Storytelling
      const story = [
        // M√≥dulos T√©cnico (para simplificar, n√£o t√™m storytelling aqui, mas poderiam ser adicionados)
        1: '', 2: '', 3: '', 4: '', 5: '', 6: '', 7: '', 8: '', 9: '', 10: '', 11: '', 12: '',
        
        // M√≥dulos Analista
        13: 'Na Ra√≠zen, tubula√ß√£o estava em ‚Äúvai e volta‚Äù. Voc√™ redesenha fluxo unidirecional e ganha 35% de produtividade.',
        14: 'Suporte sem especifica√ß√£o travou montagem. Voc√™ cobra detalhamento com anteced√™ncia e destrava frente cr√≠tica.',
        15: 'Efetivo alto sem produ√ß√£o: equipe parada esperando guindaste por 4h.',
        16: 'Material cr√≠tico chega tarde ‚Üí cronograma explode. Voc√™ cria curva de materiais alinhada ao caminho cr√≠tico.',
        17: 'Agendamento ruim ‚Üí 2 frentes paradas por causa de um √∫nico guindaste ocupando √°rea.',
        18: 'Soldas paradas sem inspetor ‚Üí backlog enorme antes do comissionamento.',
        19: 'Frontes prontas, mas sem APR ‚Üí PPC derrete e aumenta risco.',
        20: 'Faltou sistema completo para teste ‚Äî obra pronta, mas sem entregar.',
        
        // M√≥dulos Especialista
        21: 'Instrumenta√ß√£o pronta, mas tubula√ß√£o n√£o concluiu bicos ‚Üí atraso cr√≠tico no startup.',
        22: 'Visualiza√ß√£o de colis√£o entre eletrocalha e tubula√ß√£o antes da execu√ß√£o.',
        23: 'Parada com 8 dias, 600 pessoas e sincronismo absoluto para evitar atraso milion√°rio.',
        24: 'Atrito entre frentes devido √† log√≠stica de material/equipamento.',
        25: 'Painel digital revela frente cr√≠tica escondida ‚Üí a√ß√£o imediata salva prazo.',
        26: 'Mudan√ßa n√£o controlada: reembolsos e impacto no prazo ‚Üí caos administrativo.',
        27: 'Curva de produtividade melhora 20% ap√≥s 5 ciclos de repeti√ß√£o.',
        28: 'Atraso em solda: 5 porqu√™s revelam que a causa raiz √© falta de treinamento.',
        29: 'Cliente n√£o liberou √°rea porque ‚Äún√£o era prioridade‚Äù ‚Üí programa√ß√£o sem valor.',
        30: 'Voc√™ recebe dados via app no campo e ajusta programa√ß√£o no mesmo dia ‚Üí PPC explode para 87%.',

        // M√≥dulos Gerente/Diretor
        31: 'Voc√™ assume uma obra atrasada, com conflito entre equipes. Primeiro passo: restaurar confian√ßa e transpar√™ncia.',
        32: 'Produtividade baixa estoura custo ‚Üí voc√™ cria plano de recupera√ß√£o e protege a margem do contrato.',
        33: 'Reestrutura√ß√£o no cliente ‚Üí risco contratual de extens√£o ‚Üí voc√™ cria plano contingencial.',
        34: 'Painel cheio de dados ‚Äî diretoria sem entender nada. Voc√™ simplifica e ganha apoio imediado.',
        35: 'Voc√™ implementa Work Packages alinhados ao caminho cr√≠tico e integra engenharia ‚Üí fluxo perfeito.',
        36: 'Guindaste caro parado X retrabalho futuro. Voc√™ decide por custo total do ciclo, n√£o custo imediato.',

        // M√≥dulos Vision√°rio
        37: 'An√°lise preditiva aponta 80% de chance de atraso na pr√≥xima semana. A√ß√µes preventivas salvam a meta.',
        38: 'O modelo 5D prev√™ estouro de 5% no custo do m√™s. Decis√£o de realoca√ß√£o de recursos.',
        39: 'Painel de BI online unifica dados de campo, custos e planejamento em um s√≥ lugar.',
        40: 'Simula√ß√£o de Monte Carlo revela 95% de chance de terminar na data B, mas 50% na data A.',
      ][modId] || 'Teste seus conhecimentos sobre este m√≥dulo!';
      
      UI.quizStory.textContent = story;
      
      showQuizQuestion();
      switchView('quiz');
    }

    function showQuizQuestion() {
      const q = currentQuiz.questions[currentQuiz.qIndex];
      
      UI.quizQIndex.textContent = currentQuiz.qIndex + 1;
      UI.quizQuestion.textContent = q.q;
      UI.quizOptions.innerHTML = '';
      UI.quizFeedback.classList.add('hidden');
      UI.btnQuizNext.disabled = true;
      UI.btnQuizNext.classList.remove('hidden');
      UI.btnQuizFinish.classList.add('hidden');

      q.opts.forEach((opt, index) => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.setAttribute('data-index', index);
        btn.onclick = () => selectOption(btn, index, q.ok);
        UI.quizOptions.appendChild(btn);
      });
    }

    function selectOption(selectedBtn, selectedIndex, correctIndex) {
      if (!UI.btnQuizNext.disabled) return; // Se j√° respondeu, n√£o faz nada
      
      const allButtons = UI.quizOptions.querySelectorAll('button');
      allButtons.forEach(btn => {
        btn.classList.add('disabled');
        btn.disabled = true;
        btn.classList.remove('selected');
        if (parseInt(btn.getAttribute('data-index')) === correctIndex) {
          btn.classList.add('correct');
        } else {
          btn.classList.add('incorrect');
        }
      });

      selectedBtn.classList.remove('incorrect'); // Remove incorrect do bot√£o clicado para re-classificar
      selectedBtn.classList.add(selectedIndex === correctIndex ? 'correct' : 'incorrect');

      const isCorrect = selectedIndex === correctIndex;
      if (isCorrect) {
        currentQuiz.correctCount++;
        UI.quizFeedback.classList.remove('fail');
        UI.quizFeedback.classList.add('success');
        UI.quizFeedbackTitle.textContent = 'Correto! üéâ';
      } else {
        UI.quizFeedback.classList.remove('success');
        UI.quizFeedback.classList.add('fail');
        UI.quizFeedbackTitle.textContent = 'Incorreto. üòî';
      }
      
      UI.quizFeedbackExp.textContent = currentQuiz.questions[currentQuiz.qIndex].exp;
      UI.quizFeedback.classList.remove('hidden');
      
      UI.btnQuizNext.disabled = false;
      if (currentQuiz.qIndex === currentQuiz.questions.length - 1) {
        UI.btnQuizNext.classList.add('hidden');
        UI.btnQuizFinish.classList.remove('hidden');
      }
    }

    UI.btnQuizNext.onclick = () => {
      currentQuiz.qIndex++;
      if (currentQuiz.qIndex < currentQuiz.questions.length) {
        showQuizQuestion();
      }
    };

    UI.btnQuizFinish.onclick = finishQuiz;

    function finishQuiz() {
      const totalQuestions = currentQuiz.questions.length;
      const requiredCorrect = Math.ceil(totalQuestions * 0.7); // 70% de acerto
      const isApproved = currentQuiz.correctCount >= requiredCorrect;
      const modId = currentQuiz.modId;
      
      let feedbackMessage = '';
      let xpGained = 0;
      
      if (isApproved) {
        xpGained = XP_PER_MODULE;
        feedbackMessage = `Parab√©ns! Voc√™ acertou ${currentQuiz.correctCount} de ${totalQuestions} perguntas (requisito: ${requiredCorrect}). Voc√™ ganhou ${xpGained} XP!`;
        
        if (!S.completed.includes(modId)) {
          S.completed.push(modId);
          S.xp += xpGained;
        } else {
          feedbackMessage += " (M√≥dulo j√° estava conclu√≠do, sem ganho extra de XP)";
        }
      } else {
        feedbackMessage = `Ops! Voc√™ acertou apenas ${currentQuiz.correctCount} de ${totalQuestions} perguntas. Para concluir o m√≥dulo, voc√™ precisa de ${requiredCorrect} acertos. Tente novamente!`;
      }
      
      alert(feedbackMessage);
      saveState();
      switchView('dashboard');
      UI.navQuiz.classList.add('hidden'); // Esconde o bot√£o de Quiz se n√£o tiver ativo
    }
    
    // =========================================================================
    // L√ìGICA DE VIEW / NAVEGA√á√ÉO
    // =========================================================================
    
    function switchView(targetView) {
      const views = [UI.viewDash, UI.viewQuiz, UI.viewConfig, UI.viewRanking];
      views.forEach(v => v.classList.add('hidden'));
      
      if (targetView === 'dashboard') UI.viewDash.classList.remove('hidden');
      if (targetView === 'quiz') UI.viewQuiz.classList.remove('hidden');
      if (targetView === 'config') UI.viewConfig.classList.remove('hidden');
      if (targetView === 'ranking') { 
        UI.viewRanking.classList.remove('hidden');
        loadRanking();
      }

      document.querySelectorAll('.footer-nav .nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('data-view') === targetView) {
          item.classList.add('active');
        }
      });
      
      // Oculta o bot√£o de Quiz na nav se n√£o houver um quiz ativo
      if (targetView !== 'quiz') {
        UI.navQuiz.classList.add('hidden');
      }
    }
    
    document.querySelectorAll('.footer-nav .nav-item').forEach(item => {
      item.addEventListener('click', () => {
        const targetView = item.getAttribute('data-view');
        switchView(targetView);
      });
    });
    
    UI.rankBtn.onclick = () => switchView('ranking');
    UI.btnBackFromRanking.onclick = () => switchView('dashboard');

    // =========================================================================
    // L√ìGICA DE UNLOCK / DESBLOQUEIO
    // =========================================================================
    
    function promptUnlock(modId, modLevel) {
      if (S.tempPass === '2025*') {
        alert(`M√≥dulo ${modId} - ${modLevel} j√° est√° desbloqueado pela senha tempor√°ria. Clique em outro m√≥dulo ou complete os pr√©-requisitos!`);
        return;
      }
      
      const pass = prompt(`M√≥dulo ${modLevel} Bloqueado. \nDigite a senha de desbloqueio para este n√≠vel:`);
      if (pass === S.tempPass) {
        alert(`N√≠vel ${modLevel} desbloqueado!`);
        S.tempPass = pass; // Mant√©m a senha para os pr√≥ximos m√≥dulos
        saveState();
        renderModules();
      } else if (pass !== null && pass !== '') {
        alert('Senha incorreta.');
      }
    }
    
    // =========================================================================
    // INICIALIZA√á√ÉO E EVENTOS DE LOGIN
    // =========================================================================
    
    UI.btnReset.onclick = () => { 
      if(confirm("Zerar todo progresso? Isso n√£o pode ser desfeito!")){ 
        S.xp=0; S.completed=[]; S.uid=null; S.name='Usu√°rio Local'; S.updatedAt=0; S.tempPass='2025*';
        localStorage.removeItem('duoplanningState');
        signOut(auth).catch(() => {}); // Tenta deslogar do Google
        location.reload(); 
      }
    };
    
    UI.btnSignOut.onclick = () => {
      if (S.uid) {
        signOut(auth).then(() => {
          S.uid = null;
          S.name = 'Usu√°rio Local';
          saveState();
          location.reload();
        }).catch(console.error);
      } else {
        // Apenas recarrega a p√°gina para voltar para a tela de login
        location.reload();
      }
    };

    async function loadRanking(){
      UI.rankBody.innerHTML = 'Carregando...';
      try {
        const q = query(collection(db, "users"), orderBy("xp", "desc"), limit(10));
        const snap = await getDocs(q);
        UI.rankBody.innerHTML = snap.docs.map((d,i) => {
          const u = d.data();
          // Ignora usu√°rios locais que foram para o ranking sem querer
          if (!u.uid || u.uid.startsWith('local_')) return ''; 
          return `<div class="row" style="justify-content:space-between; border-bottom:1px solid #333; padding:8px 0">
            <span>${i+1}. ${u.name.substring(0,15)}</span>
            <span style="color:var(--accent)">${u.xp} XP</span>
          </div>`;
        }).join('');
      } catch(e) { UI.rankBody.textContent = "Erro ao carregar ranking. (Verifique as chaves Firebase)"; }
    }
    
    UI.btnGoogle.onclick = () => {
      signInWithPopup(auth, provider).then((result) => {
        const user = result.user;
        S.uid = user.uid;
        S.name = user.displayName;
        saveState();
        // O onAuthStateChanged cuidar√° do resto
      }).catch(console.error);
    };

    // FUN√á√ÉO QUE PROVAVELMENTE ESTAVA FALHANDO DEVIDO AO ERRO DE SINTAXE!
    UI.btnLocal.onclick = () => {
      S.name = UI.inpName.value || 'Usu√°rio Local';
      // UID local tempor√°rio para ranking, se for o caso
      S.uid = 'local_' + Date.now(); 
      saveState();
      finalizeLogin();
    };

    function finalizeLogin() {
      UI.loadingOverlay.classList.add('hidden');
      UI.viewLogin.classList.add('hidden');
      switchView('dashboard');
      updateUI();
    }

    onAuthStateChanged(auth, async (user) => {
      if(user){
        const docRef = doc(db, "users", user.uid);
        const snap = await getDoc(docRef);
        
        let cloudState = snap.exists() ? snap.data() : null;
        
        if (cloudState) {
          // Sincroniza: usa o estado mais recente (local ou nuvem)
          if(cloudState.updatedAt > S.updatedAt) S = {...S, ...cloudState};
        } else {
          // Novo usu√°rio no Firebase: salva o estado local atual na nuvem
          cloudState = { ...S, uid: user.uid, name: user.displayName, updatedAt: serverTimestamp() };
          await setDoc(docRef, cloudState);
          S = { ...S, ...cloudState };
        }
        
        S.uid = user.uid; // Garante o UID correto
        S.name = user.displayName; // Garante o nome correto
        saveState();
        
        // Listener em tempo real (opcional, mas bom)
        onSnapshot(docRef, (s) => {
           if(s.exists() && s.data().updatedAt > S.updatedAt) { 
             S = {...S, ...s.data()};
             saveState();
           }
        });
        finalizeLogin();
        
      } else if (S.name) {
         // Se n√£o est√° logado no Google, mas tem dados locais, vai para o dashboard
         finalizeLogin();
      } else {
        // Sem dados locais e sem login: mostra tela de login
        UI.loadingOverlay.classList.add('hidden');
        UI.viewLogin.classList.remove('hidden');
        UI.inpName.value = 'Mestre do Planejamento';
      }
    });

    // Inicia a aplica√ß√£o
    // O onAuthStateChanged cuida de mostrar a tela de login ou o dashboard
  </script>
</body>
</html>